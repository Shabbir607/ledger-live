var Sn=Object.defineProperty;var Rn=(i,u,a)=>u in i?Sn(i,u,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[u]=a;var B=(i,u,a)=>Rn(i,typeof u!="symbol"?u+"":u,a);import{g as Tn,a as xe,r as Ln}from"./index-0qv5noeb.js";var fe={};const Dn={},Nn=Object.freeze(Object.defineProperty({__proto__:null,default:Dn},Symbol.toStringTag,{value:"Module"})),Z=Tn(Nn);var we={exports:{}},Yt;function ge(){if(Yt)return we.exports;Yt=1;var i=typeof Reflect=="object"?Reflect:null,u=i&&typeof i.apply=="function"?i.apply:function(_,y,R){return Function.prototype.apply.call(_,y,R)},a;i&&typeof i.ownKeys=="function"?a=i.ownKeys:Object.getOwnPropertySymbols?a=function(_){return Object.getOwnPropertyNames(_).concat(Object.getOwnPropertySymbols(_))}:a=function(_){return Object.getOwnPropertyNames(_)};function s(b){console&&console.warn&&console.warn(b)}var l=Number.isNaN||function(_){return _!==_};function E(){E.init.call(this)}we.exports=E,we.exports.once=m,E.EventEmitter=E,E.prototype._events=void 0,E.prototype._eventsCount=0,E.prototype._maxListeners=void 0;var v=10;function p(b){if(typeof b!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof b)}Object.defineProperty(E,"defaultMaxListeners",{enumerable:!0,get:function(){return v},set:function(b){if(typeof b!="number"||b<0||l(b))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+b+".");v=b}}),E.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},E.prototype.setMaxListeners=function(_){if(typeof _!="number"||_<0||l(_))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+_+".");return this._maxListeners=_,this};function h(b){return b._maxListeners===void 0?E.defaultMaxListeners:b._maxListeners}E.prototype.getMaxListeners=function(){return h(this)},E.prototype.emit=function(_){for(var y=[],R=1;R<arguments.length;R++)y.push(arguments[R]);var S=_==="error",U=this._events;if(U!==void 0)S=S&&U.error===void 0;else if(!S)return!1;if(S){var P;if(y.length>0&&(P=y[0]),P instanceof Error)throw P;var G=new Error("Unhandled error."+(P?" ("+P.message+")":""));throw G.context=P,G}var x=U[_];if(x===void 0)return!1;if(typeof x=="function")u(x,this,y);else for(var $=x.length,T=c(x,$),R=0;R<$;++R)u(T[R],this,y);return!0};function f(b,_,y,R){var S,U,P;if(p(y),U=b._events,U===void 0?(U=b._events=Object.create(null),b._eventsCount=0):(U.newListener!==void 0&&(b.emit("newListener",_,y.listener?y.listener:y),U=b._events),P=U[_]),P===void 0)P=U[_]=y,++b._eventsCount;else if(typeof P=="function"?P=U[_]=R?[y,P]:[P,y]:R?P.unshift(y):P.push(y),S=h(b),S>0&&P.length>S&&!P.warned){P.warned=!0;var G=new Error("Possible EventEmitter memory leak detected. "+P.length+" "+String(_)+" listeners added. Use emitter.setMaxListeners() to increase limit");G.name="MaxListenersExceededWarning",G.emitter=b,G.type=_,G.count=P.length,s(G)}return b}E.prototype.addListener=function(_,y){return f(this,_,y,!1)},E.prototype.on=E.prototype.addListener,E.prototype.prependListener=function(_,y){return f(this,_,y,!0)};function t(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function o(b,_,y){var R={fired:!1,wrapFn:void 0,target:b,type:_,listener:y},S=t.bind(R);return S.listener=y,R.wrapFn=S,S}E.prototype.once=function(_,y){return p(y),this.on(_,o(this,_,y)),this},E.prototype.prependOnceListener=function(_,y){return p(y),this.prependListener(_,o(this,_,y)),this},E.prototype.removeListener=function(_,y){var R,S,U,P,G;if(p(y),S=this._events,S===void 0)return this;if(R=S[_],R===void 0)return this;if(R===y||R.listener===y)--this._eventsCount===0?this._events=Object.create(null):(delete S[_],S.removeListener&&this.emit("removeListener",_,R.listener||y));else if(typeof R!="function"){for(U=-1,P=R.length-1;P>=0;P--)if(R[P]===y||R[P].listener===y){G=R[P].listener,U=P;break}if(U<0)return this;U===0?R.shift():n(R,U),R.length===1&&(S[_]=R[0]),S.removeListener!==void 0&&this.emit("removeListener",_,G||y)}return this},E.prototype.off=E.prototype.removeListener,E.prototype.removeAllListeners=function(_){var y,R,S;if(R=this._events,R===void 0)return this;if(R.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):R[_]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete R[_]),this;if(arguments.length===0){var U=Object.keys(R),P;for(S=0;S<U.length;++S)P=U[S],P!=="removeListener"&&this.removeAllListeners(P);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(y=R[_],typeof y=="function")this.removeListener(_,y);else if(y!==void 0)for(S=y.length-1;S>=0;S--)this.removeListener(_,y[S]);return this};function e(b,_,y){var R=b._events;if(R===void 0)return[];var S=R[_];return S===void 0?[]:typeof S=="function"?y?[S.listener||S]:[S]:y?d(S):c(S,S.length)}E.prototype.listeners=function(_){return e(this,_,!0)},E.prototype.rawListeners=function(_){return e(this,_,!1)},E.listenerCount=function(b,_){return typeof b.listenerCount=="function"?b.listenerCount(_):r.call(b,_)},E.prototype.listenerCount=r;function r(b){var _=this._events;if(_!==void 0){var y=_[b];if(typeof y=="function")return 1;if(y!==void 0)return y.length}return 0}E.prototype.eventNames=function(){return this._eventsCount>0?a(this._events):[]};function c(b,_){for(var y=new Array(_),R=0;R<_;++R)y[R]=b[R];return y}function n(b,_){for(;_+1<b.length;_++)b[_]=b[_+1];b.pop()}function d(b){for(var _=new Array(b.length),y=0;y<_.length;++y)_[y]=b[y].listener||b[y];return _}function m(b,_){return new Promise(function(y,R){function S(P){b.removeListener(_,U),R(P)}function U(){typeof b.removeListener=="function"&&b.removeListener("error",S),y([].slice.call(arguments))}I(b,_,U,{once:!0}),_!=="error"&&g(b,S,{once:!0})})}function g(b,_,y){typeof b.on=="function"&&I(b,"error",_,y)}function I(b,_,y,R){if(typeof b.on=="function")R.once?b.once(_,y):b.on(_,y);else if(typeof b.addEventListener=="function")b.addEventListener(_,function S(U){R.once&&b.removeEventListener(_,S),y(U)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof b)}return we.exports}function qt(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Se={exports:{}},Ge,Zt;function On(){if(Zt)return Ge;Zt=1;var i=Z.sep||"/";Ge=u;function u(a){if(typeof a!="string"||a.length<=7||a.substring(0,7)!="file://")throw new TypeError("must pass in a file:// URI to convert to a file path");var s=decodeURI(a.substring(7)),l=s.indexOf("/"),E=s.substring(0,l),v=s.substring(l+1);return E=="localhost"&&(E=""),E&&(E=i+i+E),v=v.replace(/^(.+)\|/,"$1:"),i=="\\"&&(v=v.replace(/\//g,"\\")),/^.+\:/.test(v)||(v=i+v),E+v}return Ge}var Qt;function ke(){return Qt||(Qt=1,function(i,u){var a={},s=Z,l=Z,E=On(),v=l.join,p=l.dirname,h=s.accessSync&&function(o){try{s.accessSync(o)}catch{return!1}return!0}||s.existsSync||l.existsSync,f={arrow:a.NODE_BINDINGS_ARROW||" â†’ ",compiled:a.NODE_BINDINGS_COMPILED_DIR||"compiled",platform:process.platform,arch:process.arch,nodePreGyp:"node-v"+process.versions.modules+"-"+process.platform+"-"+process.arch,version:process.versions.node,bindings:"bindings.node",try:[["module_root","build","bindings"],["module_root","build","Debug","bindings"],["module_root","build","Release","bindings"],["module_root","out","Debug","bindings"],["module_root","Debug","bindings"],["module_root","out","Release","bindings"],["module_root","Release","bindings"],["module_root","build","default","bindings"],["module_root","compiled","version","platform","arch","bindings"],["module_root","addon-build","release","install-root","bindings"],["module_root","addon-build","debug","install-root","bindings"],["module_root","addon-build","default","install-root","bindings"],["module_root","lib","binding","nodePreGyp","bindings"]]};function t(o){typeof o=="string"?o={bindings:o}:o||(o={}),Object.keys(f).map(function(I){I in o||(o[I]=f[I])}),o.module_root||(o.module_root=u.getRoot(u.getFileName())),l.extname(o.bindings)!=".node"&&(o.bindings+=".node");for(var e=typeof __webpack_require__=="function"?__non_webpack_require__:qt,r=[],c=0,n=o.try.length,d,m,g;c<n;c++){d=v.apply(null,o.try[c].map(function(I){return o[I]||I})),r.push(d);try{return m=o.path?e.resolve(d):e(d),o.path||(m.path=d),m}catch(I){if(I.code!=="MODULE_NOT_FOUND"&&I.code!=="QUALIFIED_PATH_RESOLUTION_FAILED"&&!/not find/i.test(I.message))throw I}}throw g=new Error(`Could not locate the bindings file. Tried:
`+r.map(function(I){return o.arrow+I}).join(`
`)),g.tries=r,g}i.exports=u=t,u.getFileName=function(e){var r=Error.prepareStackTrace,c=Error.stackTraceLimit,n={},d;Error.stackTraceLimit=10,Error.prepareStackTrace=function(g,I){for(var b=0,_=I.length;b<_;b++)if(d=I[b].getFileName(),d!==__filename)if(e){if(d!==e)return}else return},Error.captureStackTrace(n),n.stack,Error.prepareStackTrace=r,Error.stackTraceLimit=c;var m="file://";return d.indexOf(m)===0&&(d=E(d)),d},u.getRoot=function(e){for(var r=p(e),c;;){if(r==="."&&(r=process.cwd()),h(v(r,"package.json"))||h(v(r,"node_modules")))return r;if(c===r)throw new Error('Could not find module root given file: "'+e+'". Do you have a `package.json` file? ');c=r,r=v(r,"..")}}}(Se,Se.exports)),Se.exports}var Jt;function An(){if(Jt)return fe;Jt=1;var i=Z,u=ge().EventEmitter,a=Z,s=null;function l(f){s=f}var E=null;function v(){E||(i.platform()==="linux"&&(!s||s==="hidraw")?E=ke()("HID_hidraw.node"):E=ke()("HID.node"))}function p(){u.call(this),v();var f=new Array(arguments.length+1);f[0]=null;for(var t=0;t<arguments.length;t++)f[t+1]=arguments[t];this._raw=new(Function.prototype.bind.apply(E.HID,f));for(var t in E.HID.prototype)this[t]=E.HID.prototype[t].bind(this._raw);this._paused=!0;var o=this;o.on("newListener",function(e,r){e=="data"&&process.nextTick(o.resume.bind(o))})}a.inherits(p,u),p.prototype.close=function(){this._closing=!0,this.removeAllListeners(),this._raw.close(),this._closed=!0},p.prototype.pause=function(){this._paused=!0},p.prototype.read=function(t){if(this._closed)throw new Error("Unable to read from a closed HID device");return this._raw.read(t)},p.prototype.resume=function(){var t=this;t._paused&&t.listeners("data").length>0&&(t._paused=!1,t.read(function o(e,r){e?(t._paused=!0,t._closing||t.emit("error",e)):(t.listeners("data").length<=0&&(t._paused=!0),t._paused||t.read(o),t.emit("data",r))}))};function h(){return v(),E.devices.apply(p,arguments)}return fe.HID=p,fe.devices=h,fe.setDriverType=l,fe}var xn=An();const ae=xe(xn);var Cn=ge();const dn=xe(Cn),Pn={},hn=(i,u)=>{Pn[i]=u},jt=i=>{class u extends Error{constructor(l,E,v){super(l||i,v);B(this,"cause");if(Object.setPrototypeOf(this,u.prototype),this.name=i,E)for(const p in E)this[p]=E[p];if(v&&Un(v)&&"cause"in v&&!this.cause){const p=v.cause;this.cause=p,"stack"in p&&(this.stack=this.stack+`
CAUSE: `+p.stack)}}}return u};function Un(i){return typeof i=="object"}const $n=jt("DisconnectedDevice"),Re=jt("DisconnectedDeviceDuringOperation"),Bn=jt("TransportRaceCondition");var er;(function(i){i.Unknown="Unknown",i.LocationServicesDisabled="LocationServicesDisabled",i.LocationServicesUnauthorized="LocationServicesUnauthorized",i.BluetoothScanStartFailed="BluetoothScanStartFailed"})(er||(er={}));class te extends Error{constructor(a,s){const l="TransportError";super(a||l);B(this,"id");this.name=l,this.message=a,this.stack=new Error(a).stack,this.id=s}}hn("TransportError",i=>new te(i.message,i.id));const ce={ACCESS_CONDITION_NOT_FULFILLED:38916,ALGORITHM_NOT_SUPPORTED:38020,CLA_NOT_SUPPORTED:28160,CODE_BLOCKED:38976,CODE_NOT_INITIALIZED:38914,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,CONDITIONS_OF_USE_NOT_SATISFIED:27013,CONTRADICTION_INVALIDATION:38928,CONTRADICTION_SECRET_CODE_STATUS:38920,DEVICE_IN_RECOVERY_MODE:26159,CUSTOM_IMAGE_EMPTY:26158,FILE_ALREADY_EXISTS:27273,FILE_NOT_FOUND:37892,GP_AUTH_FAILED:25344,HALTED:28586,INCONSISTENT_FILE:37896,INCORRECT_DATA:27264,INCORRECT_LENGTH:26368,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,DEVICE_NOT_ONBOARDED:27911,DEVICE_NOT_ONBOARDED_2:26129,INVALID_KCV:38021,INVALID_OFFSET:37890,LICENSING:28482,LOCKED_DEVICE:21781,MAX_VALUE_REACHED:38992,MEMORY_PROBLEM:37440,MISSING_CRITICAL_PARAMETER:26624,NO_EF_SELECTED:37888,NOT_ENOUGH_MEMORY_SPACE:27268,OK:36864,PIN_REMAINING_ATTEMPTS:25536,REFERENCED_DATA_NOT_FOUND:27272,SECURITY_STATUS_NOT_SATISFIED:27010,TECHNICAL_PROBLEM:28416,UNKNOWN_APDU:27906,USER_REFUSED_ON_DEVICE:21761,NOT_ENOUGH_SPACE:20738,APP_NOT_FOUND_OR_INVALID_CONTEXT:20771,INVALID_APP_NAME_LENGTH:26378,GEN_AES_KEY_FAILED:21529,INTERNAL_CRYPTO_OPERATION_FAILED:21530,INTERNAL_COMPUTE_AES_CMAC_FAILED:21531,ENCRYPT_APP_STORAGE_FAILED:21532,INVALID_BACKUP_STATE:26178,PIN_NOT_SET:21762,INVALID_BACKUP_LENGTH:26419,INVALID_RESTORE_STATE:26179,INVALID_CHUNK_LENGTH:26420,INVALID_BACKUP_HEADER:26698,TRUSTCHAIN_WRONG_SEED:45063};function qn(i){switch(i){case 26368:return"Incorrect length";case 26624:return"Missing critical parameter";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received";case 21781:return"Locked device"}if(28416<=i&&i<=28671)return"Internal error, please report"}class ue extends Error{constructor(a,{canBeMappedToChildError:s=!0}={}){const l=Object.keys(ce).find(h=>ce[h]===a)||"UNKNOWN_ERROR",E=qn(a)||l,v=a.toString(16),p=`Ledger device: ${E} (0x${v})`;super(p);B(this,"statusCode");B(this,"statusText");if(this.name="TransportStatusError",this.statusCode=a,this.statusText=l,Object.setPrototypeOf(this,ue.prototype),s&&a===ce.LOCKED_DEVICE)return new Ft(p)}}class Ft extends ue{constructor(u){super(ce.LOCKED_DEVICE,{canBeMappedToChildError:!1}),u&&(this.message=u),this.name="LockedDeviceError",Object.setPrototypeOf(this,Ft.prototype)}}hn("TransportStatusError",i=>new ue(i.statusCode));let pn=0;const re=[],z=(i,u,a)=>{const s={type:i,id:String(++pn),date:new Date};u&&(s.message=u),a&&(s.data=a),vn(s)},jn=({type:i,message:u,data:a,context:s})=>{const l={type:i,id:String(++pn),date:new Date};u&&(l.message=u),a&&(l.data=a),s&&(l.context=s),vn(l)};class Ee{constructor(u,a){B(this,"type");B(this,"context");this.type=u,this.context=a}trace(u,a){jn({type:this.type,message:u,data:a,context:this.context})}getContext(){return this.context}setContext(u){this.context=u}updateContext(u){this.context={...this.context,...u}}getType(){return this.type}setType(u){this.type=u}withType(u){return new Ee(u,this.context)}withContext(u){return new Ee(this.type,u)}withUpdatedContext(u){return new Ee(this.type,{...this.context,...u})}}const Fn=i=>(re.push(i),()=>{const u=re.indexOf(i);u!==-1&&(re[u]=re[re.length-1],re.pop())});function vn(i){for(let u=0;u<re.length;u++)try{re[u](i)}catch(a){console.error(a)}}typeof window<"u"&&(window.__ledgerLogsListen=Fn);const Mn="transport";class se{constructor({context:u,logType:a}={}){B(this,"exchangeTimeout",3e4);B(this,"unresponsiveTimeout",15e3);B(this,"deviceModel",null);B(this,"tracer");B(this,"_events",new dn);B(this,"send",async(u,a,s,l,E=Buffer.alloc(0),v=[ce.OK],{abortTimeoutMs:p}={})=>{const h=this.tracer.withUpdatedContext({function:"send"});if(E.length>=256)throw h.trace("data.length exceeded 256 bytes limit",{dataLength:E.length}),new te("data.length exceed 256 bytes limit. Got: "+E.length,"DataLengthTooBig");h.trace("Starting an exchange",{abortTimeoutMs:p});const f=await this.exchange(Buffer.concat([Buffer.from([u,a,s,l]),Buffer.from([E.length]),E]),{abortTimeoutMs:p});h.trace("Received response from exchange");const t=f.readUInt16BE(f.length-2);if(!v.some(o=>o===t))throw new ue(t);return f});B(this,"exchangeBusyPromise");B(this,"_appAPIlock",null);this.tracer=new Ee(a??Mn,u)}exchange(u,{abortTimeoutMs:a}={}){throw new Error("exchange not implemented")}exchangeBulk(u,a){let s=!1;const l=()=>{s=!0};return(async()=>{if(!s)for(const v of u){const p=await this.exchange(v);if(s)return;const h=p.readUInt16BE(p.length-2);if(h!==ce.OK)throw new ue(h);a.next(p)}})().then(()=>!s&&a.complete(),v=>!s&&a.error(v)),{unsubscribe:l}}setScrambleKey(u){}close(){return Promise.resolve()}on(u,a){this._events.on(u,a)}off(u,a){this._events.removeListener(u,a)}emit(u,...a){this._events.emit(u,...a)}setDebugMode(){console.warn("setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.")}setExchangeTimeout(u){this.exchangeTimeout=u}setExchangeUnresponsiveTimeout(u){this.unresponsiveTimeout=u}static create(u=3e3,a){return new Promise((s,l)=>{let E=!1;const v=this.listen({next:h=>{E=!0,v&&v.unsubscribe(),p&&clearTimeout(p),this.open(h.descriptor,u).then(s,l)},error:h=>{p&&clearTimeout(p),l(h)},complete:()=>{p&&clearTimeout(p),E||l(new te(this.ErrorMessage_NoDeviceFound,"NoDeviceFound"))}}),p=a?setTimeout(()=>{v.unsubscribe(),l(new te(this.ErrorMessage_ListenTimeout,"ListenTimeout"))},a):null})}async exchangeAtomicImpl(u){const a=this.tracer.withUpdatedContext({function:"exchangeAtomicImpl",unresponsiveTimeout:this.unresponsiveTimeout});if(this.exchangeBusyPromise)throw a.trace("Atomic exchange is already busy"),new Bn("An action was already pending on the Ledger device. Please deny or reconnect.");let s;const l=new Promise(p=>{s=p});this.exchangeBusyPromise=l;let E=!1;const v=setTimeout(()=>{a.trace('Timeout reached, emitting Transport event "unresponsive"',{unresponsiveTimeout:this.unresponsiveTimeout}),E=!0,this.emit("unresponsive")},this.unresponsiveTimeout);try{const p=await u();return E&&(a.trace("Device was unresponsive, emitting responsive"),this.emit("responsive")),p}finally{a.trace("Finalize, clearing busy guard"),clearTimeout(v),s&&s(),this.exchangeBusyPromise=null}}decorateAppAPIMethods(u,a,s){for(const l of a)u[l]=this.decorateAppAPIMethod(l,u[l],u,s)}decorateAppAPIMethod(u,a,s,l){return async(...E)=>{const{_appAPIlock:v}=this;if(v)return Promise.reject(new te("Ledger Device is busy (lock "+v+")","TransportLocked"));try{return this._appAPIlock=u,this.setScrambleKey(l),await a.apply(s,E)}finally{this._appAPIlock=null}}}setTraceContext(u){this.tracer=this.tracer.withContext(u)}updateTraceContext(u){this.tracer.updateContext(u)}getTraceContext(){return this.tracer.getContext()}}B(se,"isSupported"),B(se,"list"),B(se,"listen"),B(se,"open"),B(se,"ErrorMessage_ListenTimeout","No Ledger device found (timeout)"),B(se,"ErrorMessage_NoDeviceFound","No Ledger device found");var Te={exports:{}},Ve,tr;function Ce(){if(tr)return Ve;tr=1;const i="2.0.0",u=256,a=Number.MAX_SAFE_INTEGER||9007199254740991,s=16,l=u-6;return Ve={MAX_LENGTH:u,MAX_SAFE_COMPONENT_LENGTH:s,MAX_SAFE_BUILD_LENGTH:l,MAX_SAFE_INTEGER:a,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:i,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},Ve}var He,rr;function Pe(){if(rr)return He;rr=1;var i={};return He=typeof process=="object"&&i&&i.NODE_DEBUG&&/\bsemver\b/i.test(i.NODE_DEBUG)?(...a)=>console.error("SEMVER",...a):()=>{},He}var nr;function _e(){return nr||(nr=1,function(i,u){const{MAX_SAFE_COMPONENT_LENGTH:a,MAX_SAFE_BUILD_LENGTH:s,MAX_LENGTH:l}=Ce(),E=Pe();u=i.exports={};const v=u.re=[],p=u.safeRe=[],h=u.src=[],f=u.safeSrc=[],t=u.t={};let o=0;const e="[a-zA-Z0-9-]",r=[["\\s",1],["\\d",l],[e,s]],c=d=>{for(const[m,g]of r)d=d.split(`${m}*`).join(`${m}{0,${g}}`).split(`${m}+`).join(`${m}{1,${g}}`);return d},n=(d,m,g)=>{const I=c(m),b=o++;E(d,b,m),t[d]=b,h[b]=m,f[b]=I,v[b]=new RegExp(m,g?"g":void 0),p[b]=new RegExp(I,g?"g":void 0)};n("NUMERICIDENTIFIER","0|[1-9]\\d*"),n("NUMERICIDENTIFIERLOOSE","\\d+"),n("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${e}*`),n("MAINVERSION",`(${h[t.NUMERICIDENTIFIER]})\\.(${h[t.NUMERICIDENTIFIER]})\\.(${h[t.NUMERICIDENTIFIER]})`),n("MAINVERSIONLOOSE",`(${h[t.NUMERICIDENTIFIERLOOSE]})\\.(${h[t.NUMERICIDENTIFIERLOOSE]})\\.(${h[t.NUMERICIDENTIFIERLOOSE]})`),n("PRERELEASEIDENTIFIER",`(?:${h[t.NONNUMERICIDENTIFIER]}|${h[t.NUMERICIDENTIFIER]})`),n("PRERELEASEIDENTIFIERLOOSE",`(?:${h[t.NONNUMERICIDENTIFIER]}|${h[t.NUMERICIDENTIFIERLOOSE]})`),n("PRERELEASE",`(?:-(${h[t.PRERELEASEIDENTIFIER]}(?:\\.${h[t.PRERELEASEIDENTIFIER]})*))`),n("PRERELEASELOOSE",`(?:-?(${h[t.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${h[t.PRERELEASEIDENTIFIERLOOSE]})*))`),n("BUILDIDENTIFIER",`${e}+`),n("BUILD",`(?:\\+(${h[t.BUILDIDENTIFIER]}(?:\\.${h[t.BUILDIDENTIFIER]})*))`),n("FULLPLAIN",`v?${h[t.MAINVERSION]}${h[t.PRERELEASE]}?${h[t.BUILD]}?`),n("FULL",`^${h[t.FULLPLAIN]}$`),n("LOOSEPLAIN",`[v=\\s]*${h[t.MAINVERSIONLOOSE]}${h[t.PRERELEASELOOSE]}?${h[t.BUILD]}?`),n("LOOSE",`^${h[t.LOOSEPLAIN]}$`),n("GTLT","((?:<|>)?=?)"),n("XRANGEIDENTIFIERLOOSE",`${h[t.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),n("XRANGEIDENTIFIER",`${h[t.NUMERICIDENTIFIER]}|x|X|\\*`),n("XRANGEPLAIN",`[v=\\s]*(${h[t.XRANGEIDENTIFIER]})(?:\\.(${h[t.XRANGEIDENTIFIER]})(?:\\.(${h[t.XRANGEIDENTIFIER]})(?:${h[t.PRERELEASE]})?${h[t.BUILD]}?)?)?`),n("XRANGEPLAINLOOSE",`[v=\\s]*(${h[t.XRANGEIDENTIFIERLOOSE]})(?:\\.(${h[t.XRANGEIDENTIFIERLOOSE]})(?:\\.(${h[t.XRANGEIDENTIFIERLOOSE]})(?:${h[t.PRERELEASELOOSE]})?${h[t.BUILD]}?)?)?`),n("XRANGE",`^${h[t.GTLT]}\\s*${h[t.XRANGEPLAIN]}$`),n("XRANGELOOSE",`^${h[t.GTLT]}\\s*${h[t.XRANGEPLAINLOOSE]}$`),n("COERCEPLAIN",`(^|[^\\d])(\\d{1,${a}})(?:\\.(\\d{1,${a}}))?(?:\\.(\\d{1,${a}}))?`),n("COERCE",`${h[t.COERCEPLAIN]}(?:$|[^\\d])`),n("COERCEFULL",h[t.COERCEPLAIN]+`(?:${h[t.PRERELEASE]})?(?:${h[t.BUILD]})?(?:$|[^\\d])`),n("COERCERTL",h[t.COERCE],!0),n("COERCERTLFULL",h[t.COERCEFULL],!0),n("LONETILDE","(?:~>?)"),n("TILDETRIM",`(\\s*)${h[t.LONETILDE]}\\s+`,!0),u.tildeTrimReplace="$1~",n("TILDE",`^${h[t.LONETILDE]}${h[t.XRANGEPLAIN]}$`),n("TILDELOOSE",`^${h[t.LONETILDE]}${h[t.XRANGEPLAINLOOSE]}$`),n("LONECARET","(?:\\^)"),n("CARETTRIM",`(\\s*)${h[t.LONECARET]}\\s+`,!0),u.caretTrimReplace="$1^",n("CARET",`^${h[t.LONECARET]}${h[t.XRANGEPLAIN]}$`),n("CARETLOOSE",`^${h[t.LONECARET]}${h[t.XRANGEPLAINLOOSE]}$`),n("COMPARATORLOOSE",`^${h[t.GTLT]}\\s*(${h[t.LOOSEPLAIN]})$|^$`),n("COMPARATOR",`^${h[t.GTLT]}\\s*(${h[t.FULLPLAIN]})$|^$`),n("COMPARATORTRIM",`(\\s*)${h[t.GTLT]}\\s*(${h[t.LOOSEPLAIN]}|${h[t.XRANGEPLAIN]})`,!0),u.comparatorTrimReplace="$1$2$3",n("HYPHENRANGE",`^\\s*(${h[t.XRANGEPLAIN]})\\s+-\\s+(${h[t.XRANGEPLAIN]})\\s*$`),n("HYPHENRANGELOOSE",`^\\s*(${h[t.XRANGEPLAINLOOSE]})\\s+-\\s+(${h[t.XRANGEPLAINLOOSE]})\\s*$`),n("STAR","(<|>)?=?\\s*\\*"),n("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),n("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(Te,Te.exports)),Te.exports}var Xe,ir;function Mt(){if(ir)return Xe;ir=1;const i=Object.freeze({loose:!0}),u=Object.freeze({});return Xe=s=>s?typeof s!="object"?i:s:u,Xe}var We,sr;function En(){if(sr)return We;sr=1;const i=/^[0-9]+$/,u=(s,l)=>{const E=i.test(s),v=i.test(l);return E&&v&&(s=+s,l=+l),s===l?0:E&&!v?-1:v&&!E?1:s<l?-1:1};return We={compareIdentifiers:u,rcompareIdentifiers:(s,l)=>u(l,s)},We}var ze,or;function H(){if(or)return ze;or=1;const i=Pe(),{MAX_LENGTH:u,MAX_SAFE_INTEGER:a}=Ce(),{safeRe:s,t:l}=_e(),E=Mt(),{compareIdentifiers:v}=En();class p{constructor(f,t){if(t=E(t),f instanceof p){if(f.loose===!!t.loose&&f.includePrerelease===!!t.includePrerelease)return f;f=f.version}else if(typeof f!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof f}".`);if(f.length>u)throw new TypeError(`version is longer than ${u} characters`);i("SemVer",f,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const o=f.trim().match(t.loose?s[l.LOOSE]:s[l.FULL]);if(!o)throw new TypeError(`Invalid Version: ${f}`);if(this.raw=f,this.major=+o[1],this.minor=+o[2],this.patch=+o[3],this.major>a||this.major<0)throw new TypeError("Invalid major version");if(this.minor>a||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>a||this.patch<0)throw new TypeError("Invalid patch version");o[4]?this.prerelease=o[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){const r=+e;if(r>=0&&r<a)return r}return e}):this.prerelease=[],this.build=o[5]?o[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(f){if(i("SemVer.compare",this.version,this.options,f),!(f instanceof p)){if(typeof f=="string"&&f===this.version)return 0;f=new p(f,this.options)}return f.version===this.version?0:this.compareMain(f)||this.comparePre(f)}compareMain(f){return f instanceof p||(f=new p(f,this.options)),v(this.major,f.major)||v(this.minor,f.minor)||v(this.patch,f.patch)}comparePre(f){if(f instanceof p||(f=new p(f,this.options)),this.prerelease.length&&!f.prerelease.length)return-1;if(!this.prerelease.length&&f.prerelease.length)return 1;if(!this.prerelease.length&&!f.prerelease.length)return 0;let t=0;do{const o=this.prerelease[t],e=f.prerelease[t];if(i("prerelease compare",t,o,e),o===void 0&&e===void 0)return 0;if(e===void 0)return 1;if(o===void 0)return-1;if(o===e)continue;return v(o,e)}while(++t)}compareBuild(f){f instanceof p||(f=new p(f,this.options));let t=0;do{const o=this.build[t],e=f.build[t];if(i("build compare",t,o,e),o===void 0&&e===void 0)return 0;if(e===void 0)return 1;if(o===void 0)return-1;if(o===e)continue;return v(o,e)}while(++t)}inc(f,t,o){if(f.startsWith("pre")){if(!t&&o===!1)throw new Error("invalid increment argument: identifier is empty");if(t){const e=`-${t}`.match(this.options.loose?s[l.PRERELEASELOOSE]:s[l.PRERELEASE]);if(!e||e[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(f){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,o);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,o);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,o),this.inc("pre",t,o);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,o),this.inc("pre",t,o);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(o)?1:0;if(this.prerelease.length===0)this.prerelease=[e];else{let r=this.prerelease.length;for(;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);if(r===-1){if(t===this.prerelease.join(".")&&o===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let r=[t,e];o===!1&&(r=[t]),v(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=r):this.prerelease=r}break}default:throw new Error(`invalid increment argument: ${f}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return ze=p,ze}var Ke,ar;function le(){if(ar)return Ke;ar=1;const i=H();return Ke=(a,s,l=!1)=>{if(a instanceof i)return a;try{return new i(a,s)}catch(E){if(!l)return null;throw E}},Ke}var Ye,cr;function Gn(){if(cr)return Ye;cr=1;const i=le();return Ye=(a,s)=>{const l=i(a,s);return l?l.version:null},Ye}var Ze,ur;function kn(){if(ur)return Ze;ur=1;const i=le();return Ze=(a,s)=>{const l=i(a.trim().replace(/^[=v]+/,""),s);return l?l.version:null},Ze}var Qe,lr;function Vn(){if(lr)return Qe;lr=1;const i=H();return Qe=(a,s,l,E,v)=>{typeof l=="string"&&(v=E,E=l,l=void 0);try{return new i(a instanceof i?a.version:a,l).inc(s,E,v).version}catch{return null}},Qe}var Je,fr;function Hn(){if(fr)return Je;fr=1;const i=le();return Je=(a,s)=>{const l=i(a,null,!0),E=i(s,null,!0),v=l.compare(E);if(v===0)return null;const p=v>0,h=p?l:E,f=p?E:l,t=!!h.prerelease.length;if(!!f.prerelease.length&&!t){if(!f.patch&&!f.minor)return"major";if(f.compareMain(h)===0)return f.minor&&!f.patch?"minor":"patch"}const e=t?"pre":"";return l.major!==E.major?e+"major":l.minor!==E.minor?e+"minor":l.patch!==E.patch?e+"patch":"prerelease"},Je}var et,dr;function Xn(){if(dr)return et;dr=1;const i=H();return et=(a,s)=>new i(a,s).major,et}var tt,hr;function Wn(){if(hr)return tt;hr=1;const i=H();return tt=(a,s)=>new i(a,s).minor,tt}var rt,pr;function zn(){if(pr)return rt;pr=1;const i=H();return rt=(a,s)=>new i(a,s).patch,rt}var nt,vr;function Kn(){if(vr)return nt;vr=1;const i=le();return nt=(a,s)=>{const l=i(a,s);return l&&l.prerelease.length?l.prerelease:null},nt}var it,Er;function Q(){if(Er)return it;Er=1;const i=H();return it=(a,s,l)=>new i(a,l).compare(new i(s,l)),it}var st,mr;function Yn(){if(mr)return st;mr=1;const i=Q();return st=(a,s,l)=>i(s,a,l),st}var ot,gr;function Zn(){if(gr)return ot;gr=1;const i=Q();return ot=(a,s)=>i(a,s,!0),ot}var at,_r;function Gt(){if(_r)return at;_r=1;const i=H();return at=(a,s,l)=>{const E=new i(a,l),v=new i(s,l);return E.compare(v)||E.compareBuild(v)},at}var ct,yr;function Qn(){if(yr)return ct;yr=1;const i=Gt();return ct=(a,s)=>a.sort((l,E)=>i(l,E,s)),ct}var ut,br;function Jn(){if(br)return ut;br=1;const i=Gt();return ut=(a,s)=>a.sort((l,E)=>i(E,l,s)),ut}var lt,Ir;function Ue(){if(Ir)return lt;Ir=1;const i=Q();return lt=(a,s,l)=>i(a,s,l)>0,lt}var ft,wr;function kt(){if(wr)return ft;wr=1;const i=Q();return ft=(a,s,l)=>i(a,s,l)<0,ft}var dt,Sr;function mn(){if(Sr)return dt;Sr=1;const i=Q();return dt=(a,s,l)=>i(a,s,l)===0,dt}var ht,Rr;function gn(){if(Rr)return ht;Rr=1;const i=Q();return ht=(a,s,l)=>i(a,s,l)!==0,ht}var pt,Tr;function Vt(){if(Tr)return pt;Tr=1;const i=Q();return pt=(a,s,l)=>i(a,s,l)>=0,pt}var vt,Lr;function Ht(){if(Lr)return vt;Lr=1;const i=Q();return vt=(a,s,l)=>i(a,s,l)<=0,vt}var Et,Dr;function _n(){if(Dr)return Et;Dr=1;const i=mn(),u=gn(),a=Ue(),s=Vt(),l=kt(),E=Ht();return Et=(p,h,f,t)=>{switch(h){case"===":return typeof p=="object"&&(p=p.version),typeof f=="object"&&(f=f.version),p===f;case"!==":return typeof p=="object"&&(p=p.version),typeof f=="object"&&(f=f.version),p!==f;case"":case"=":case"==":return i(p,f,t);case"!=":return u(p,f,t);case">":return a(p,f,t);case">=":return s(p,f,t);case"<":return l(p,f,t);case"<=":return E(p,f,t);default:throw new TypeError(`Invalid operator: ${h}`)}},Et}var mt,Nr;function ei(){if(Nr)return mt;Nr=1;const i=H(),u=le(),{safeRe:a,t:s}=_e();return mt=(E,v)=>{if(E instanceof i)return E;if(typeof E=="number"&&(E=String(E)),typeof E!="string")return null;v=v||{};let p=null;if(!v.rtl)p=E.match(v.includePrerelease?a[s.COERCEFULL]:a[s.COERCE]);else{const r=v.includePrerelease?a[s.COERCERTLFULL]:a[s.COERCERTL];let c;for(;(c=r.exec(E))&&(!p||p.index+p[0].length!==E.length);)(!p||c.index+c[0].length!==p.index+p[0].length)&&(p=c),r.lastIndex=c.index+c[1].length+c[2].length;r.lastIndex=-1}if(p===null)return null;const h=p[2],f=p[3]||"0",t=p[4]||"0",o=v.includePrerelease&&p[5]?`-${p[5]}`:"",e=v.includePrerelease&&p[6]?`+${p[6]}`:"";return u(`${h}.${f}.${t}${o}${e}`,v)},mt}var gt,Or;function ti(){if(Or)return gt;Or=1;class i{constructor(){this.max=1e3,this.map=new Map}get(a){const s=this.map.get(a);if(s!==void 0)return this.map.delete(a),this.map.set(a,s),s}delete(a){return this.map.delete(a)}set(a,s){if(!this.delete(a)&&s!==void 0){if(this.map.size>=this.max){const E=this.map.keys().next().value;this.delete(E)}this.map.set(a,s)}return this}}return gt=i,gt}var _t,Ar;function J(){if(Ar)return _t;Ar=1;const i=/\s+/g;class u{constructor(w,N){if(N=l(N),w instanceof u)return w.loose===!!N.loose&&w.includePrerelease===!!N.includePrerelease?w:new u(w.raw,N);if(w instanceof E)return this.raw=w.value,this.set=[[w]],this.formatted=void 0,this;if(this.options=N,this.loose=!!N.loose,this.includePrerelease=!!N.includePrerelease,this.raw=w.trim().replace(i," "),this.set=this.raw.split("||").map(L=>this.parseRange(L.trim())).filter(L=>L.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const L=this.set[0];if(this.set=this.set.filter(O=>!n(O[0])),this.set.length===0)this.set=[L];else if(this.set.length>1){for(const O of this.set)if(O.length===1&&d(O[0])){this.set=[O];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let w=0;w<this.set.length;w++){w>0&&(this.formatted+="||");const N=this.set[w];for(let L=0;L<N.length;L++)L>0&&(this.formatted+=" "),this.formatted+=N[L].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(w){const L=((this.options.includePrerelease&&r)|(this.options.loose&&c))+":"+w,O=s.get(L);if(O)return O;const D=this.options.loose,A=D?h[f.HYPHENRANGELOOSE]:h[f.HYPHENRANGE];w=w.replace(A,x(this.options.includePrerelease)),v("hyphen replace",w),w=w.replace(h[f.COMPARATORTRIM],t),v("comparator trim",w),w=w.replace(h[f.TILDETRIM],o),v("tilde trim",w),w=w.replace(h[f.CARETTRIM],e),v("caret trim",w);let q=w.split(" ").map(F=>g(F,this.options)).join(" ").split(/\s+/).map(F=>G(F,this.options));D&&(q=q.filter(F=>(v("loose invalid filter",F,this.options),!!F.match(h[f.COMPARATORLOOSE])))),v("range list",q);const C=new Map,j=q.map(F=>new E(F,this.options));for(const F of j){if(n(F))return[F];C.set(F.value,F)}C.size>1&&C.has("")&&C.delete("");const M=[...C.values()];return s.set(L,M),M}intersects(w,N){if(!(w instanceof u))throw new TypeError("a Range is required");return this.set.some(L=>m(L,N)&&w.set.some(O=>m(O,N)&&L.every(D=>O.every(A=>D.intersects(A,N)))))}test(w){if(!w)return!1;if(typeof w=="string")try{w=new p(w,this.options)}catch{return!1}for(let N=0;N<this.set.length;N++)if($(this.set[N],w,this.options))return!0;return!1}}_t=u;const a=ti(),s=new a,l=Mt(),E=$e(),v=Pe(),p=H(),{safeRe:h,t:f,comparatorTrimReplace:t,tildeTrimReplace:o,caretTrimReplace:e}=_e(),{FLAG_INCLUDE_PRERELEASE:r,FLAG_LOOSE:c}=Ce(),n=T=>T.value==="<0.0.0-0",d=T=>T.value==="",m=(T,w)=>{let N=!0;const L=T.slice();let O=L.pop();for(;N&&L.length;)N=L.every(D=>O.intersects(D,w)),O=L.pop();return N},g=(T,w)=>(v("comp",T,w),T=y(T,w),v("caret",T),T=b(T,w),v("tildes",T),T=S(T,w),v("xrange",T),T=P(T,w),v("stars",T),T),I=T=>!T||T.toLowerCase()==="x"||T==="*",b=(T,w)=>T.trim().split(/\s+/).map(N=>_(N,w)).join(" "),_=(T,w)=>{const N=w.loose?h[f.TILDELOOSE]:h[f.TILDE];return T.replace(N,(L,O,D,A,q)=>{v("tilde",T,L,O,D,A,q);let C;return I(O)?C="":I(D)?C=`>=${O}.0.0 <${+O+1}.0.0-0`:I(A)?C=`>=${O}.${D}.0 <${O}.${+D+1}.0-0`:q?(v("replaceTilde pr",q),C=`>=${O}.${D}.${A}-${q} <${O}.${+D+1}.0-0`):C=`>=${O}.${D}.${A} <${O}.${+D+1}.0-0`,v("tilde return",C),C})},y=(T,w)=>T.trim().split(/\s+/).map(N=>R(N,w)).join(" "),R=(T,w)=>{v("caret",T,w);const N=w.loose?h[f.CARETLOOSE]:h[f.CARET],L=w.includePrerelease?"-0":"";return T.replace(N,(O,D,A,q,C)=>{v("caret",T,O,D,A,q,C);let j;return I(D)?j="":I(A)?j=`>=${D}.0.0${L} <${+D+1}.0.0-0`:I(q)?D==="0"?j=`>=${D}.${A}.0${L} <${D}.${+A+1}.0-0`:j=`>=${D}.${A}.0${L} <${+D+1}.0.0-0`:C?(v("replaceCaret pr",C),D==="0"?A==="0"?j=`>=${D}.${A}.${q}-${C} <${D}.${A}.${+q+1}-0`:j=`>=${D}.${A}.${q}-${C} <${D}.${+A+1}.0-0`:j=`>=${D}.${A}.${q}-${C} <${+D+1}.0.0-0`):(v("no pr"),D==="0"?A==="0"?j=`>=${D}.${A}.${q}${L} <${D}.${A}.${+q+1}-0`:j=`>=${D}.${A}.${q}${L} <${D}.${+A+1}.0-0`:j=`>=${D}.${A}.${q} <${+D+1}.0.0-0`),v("caret return",j),j})},S=(T,w)=>(v("replaceXRanges",T,w),T.split(/\s+/).map(N=>U(N,w)).join(" ")),U=(T,w)=>{T=T.trim();const N=w.loose?h[f.XRANGELOOSE]:h[f.XRANGE];return T.replace(N,(L,O,D,A,q,C)=>{v("xRange",T,L,O,D,A,q,C);const j=I(D),M=j||I(A),F=M||I(q),W=F;return O==="="&&W&&(O=""),C=w.includePrerelease?"-0":"",j?O===">"||O==="<"?L="<0.0.0-0":L="*":O&&W?(M&&(A=0),q=0,O===">"?(O=">=",M?(D=+D+1,A=0,q=0):(A=+A+1,q=0)):O==="<="&&(O="<",M?D=+D+1:A=+A+1),O==="<"&&(C="-0"),L=`${O+D}.${A}.${q}${C}`):M?L=`>=${D}.0.0${C} <${+D+1}.0.0-0`:F&&(L=`>=${D}.${A}.0${C} <${D}.${+A+1}.0-0`),v("xRange return",L),L})},P=(T,w)=>(v("replaceStars",T,w),T.trim().replace(h[f.STAR],"")),G=(T,w)=>(v("replaceGTE0",T,w),T.trim().replace(h[w.includePrerelease?f.GTE0PRE:f.GTE0],"")),x=T=>(w,N,L,O,D,A,q,C,j,M,F,W)=>(I(L)?N="":I(O)?N=`>=${L}.0.0${T?"-0":""}`:I(D)?N=`>=${L}.${O}.0${T?"-0":""}`:A?N=`>=${N}`:N=`>=${N}${T?"-0":""}`,I(j)?C="":I(M)?C=`<${+j+1}.0.0-0`:I(F)?C=`<${j}.${+M+1}.0-0`:W?C=`<=${j}.${M}.${F}-${W}`:T?C=`<${j}.${M}.${+F+1}-0`:C=`<=${C}`,`${N} ${C}`.trim()),$=(T,w,N)=>{for(let L=0;L<T.length;L++)if(!T[L].test(w))return!1;if(w.prerelease.length&&!N.includePrerelease){for(let L=0;L<T.length;L++)if(v(T[L].semver),T[L].semver!==E.ANY&&T[L].semver.prerelease.length>0){const O=T[L].semver;if(O.major===w.major&&O.minor===w.minor&&O.patch===w.patch)return!0}return!1}return!0};return _t}var yt,xr;function $e(){if(xr)return yt;xr=1;const i=Symbol("SemVer ANY");class u{static get ANY(){return i}constructor(t,o){if(o=a(o),t instanceof u){if(t.loose===!!o.loose)return t;t=t.value}t=t.trim().split(/\s+/).join(" "),v("comparator",t,o),this.options=o,this.loose=!!o.loose,this.parse(t),this.semver===i?this.value="":this.value=this.operator+this.semver.version,v("comp",this)}parse(t){const o=this.options.loose?s[l.COMPARATORLOOSE]:s[l.COMPARATOR],e=t.match(o);if(!e)throw new TypeError(`Invalid comparator: ${t}`);this.operator=e[1]!==void 0?e[1]:"",this.operator==="="&&(this.operator=""),e[2]?this.semver=new p(e[2],this.options.loose):this.semver=i}toString(){return this.value}test(t){if(v("Comparator.test",t,this.options.loose),this.semver===i||t===i)return!0;if(typeof t=="string")try{t=new p(t,this.options)}catch{return!1}return E(t,this.operator,this.semver,this.options)}intersects(t,o){if(!(t instanceof u))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new h(t.value,o).test(this.value):t.operator===""?t.value===""?!0:new h(this.value,o).test(t.semver):(o=a(o),o.includePrerelease&&(this.value==="<0.0.0-0"||t.value==="<0.0.0-0")||!o.includePrerelease&&(this.value.startsWith("<0.0.0")||t.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&t.operator.startsWith(">")||this.operator.startsWith("<")&&t.operator.startsWith("<")||this.semver.version===t.semver.version&&this.operator.includes("=")&&t.operator.includes("=")||E(this.semver,"<",t.semver,o)&&this.operator.startsWith(">")&&t.operator.startsWith("<")||E(this.semver,">",t.semver,o)&&this.operator.startsWith("<")&&t.operator.startsWith(">")))}}yt=u;const a=Mt(),{safeRe:s,t:l}=_e(),E=_n(),v=Pe(),p=H(),h=J();return yt}var bt,Cr;function Be(){if(Cr)return bt;Cr=1;const i=J();return bt=(a,s,l)=>{try{s=new i(s,l)}catch{return!1}return s.test(a)},bt}var It,Pr;function ri(){if(Pr)return It;Pr=1;const i=J();return It=(a,s)=>new i(a,s).set.map(l=>l.map(E=>E.value).join(" ").trim().split(" ")),It}var wt,Ur;function ni(){if(Ur)return wt;Ur=1;const i=H(),u=J();return wt=(s,l,E)=>{let v=null,p=null,h=null;try{h=new u(l,E)}catch{return null}return s.forEach(f=>{h.test(f)&&(!v||p.compare(f)===-1)&&(v=f,p=new i(v,E))}),v},wt}var St,$r;function ii(){if($r)return St;$r=1;const i=H(),u=J();return St=(s,l,E)=>{let v=null,p=null,h=null;try{h=new u(l,E)}catch{return null}return s.forEach(f=>{h.test(f)&&(!v||p.compare(f)===1)&&(v=f,p=new i(v,E))}),v},St}var Rt,Br;function si(){if(Br)return Rt;Br=1;const i=H(),u=J(),a=Ue();return Rt=(l,E)=>{l=new u(l,E);let v=new i("0.0.0");if(l.test(v)||(v=new i("0.0.0-0"),l.test(v)))return v;v=null;for(let p=0;p<l.set.length;++p){const h=l.set[p];let f=null;h.forEach(t=>{const o=new i(t.semver.version);switch(t.operator){case">":o.prerelease.length===0?o.patch++:o.prerelease.push(0),o.raw=o.format();case"":case">=":(!f||a(o,f))&&(f=o);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${t.operator}`)}}),f&&(!v||a(v,f))&&(v=f)}return v&&l.test(v)?v:null},Rt}var Tt,qr;function oi(){if(qr)return Tt;qr=1;const i=J();return Tt=(a,s)=>{try{return new i(a,s).range||"*"}catch{return null}},Tt}var Lt,jr;function Xt(){if(jr)return Lt;jr=1;const i=H(),u=$e(),{ANY:a}=u,s=J(),l=Be(),E=Ue(),v=kt(),p=Ht(),h=Vt();return Lt=(t,o,e,r)=>{t=new i(t,r),o=new s(o,r);let c,n,d,m,g;switch(e){case">":c=E,n=p,d=v,m=">",g=">=";break;case"<":c=v,n=h,d=E,m="<",g="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(l(t,o,r))return!1;for(let I=0;I<o.set.length;++I){const b=o.set[I];let _=null,y=null;if(b.forEach(R=>{R.semver===a&&(R=new u(">=0.0.0")),_=_||R,y=y||R,c(R.semver,_.semver,r)?_=R:d(R.semver,y.semver,r)&&(y=R)}),_.operator===m||_.operator===g||(!y.operator||y.operator===m)&&n(t,y.semver))return!1;if(y.operator===g&&d(t,y.semver))return!1}return!0},Lt}var Dt,Fr;function ai(){if(Fr)return Dt;Fr=1;const i=Xt();return Dt=(a,s,l)=>i(a,s,">",l),Dt}var Nt,Mr;function ci(){if(Mr)return Nt;Mr=1;const i=Xt();return Nt=(a,s,l)=>i(a,s,"<",l),Nt}var Ot,Gr;function ui(){if(Gr)return Ot;Gr=1;const i=J();return Ot=(a,s,l)=>(a=new i(a,l),s=new i(s,l),a.intersects(s,l)),Ot}var At,kr;function li(){if(kr)return At;kr=1;const i=Be(),u=Q();return At=(a,s,l)=>{const E=[];let v=null,p=null;const h=a.sort((e,r)=>u(e,r,l));for(const e of h)i(e,s,l)?(p=e,v||(v=e)):(p&&E.push([v,p]),p=null,v=null);v&&E.push([v,null]);const f=[];for(const[e,r]of E)e===r?f.push(e):!r&&e===h[0]?f.push("*"):r?e===h[0]?f.push(`<=${r}`):f.push(`${e} - ${r}`):f.push(`>=${e}`);const t=f.join(" || "),o=typeof s.raw=="string"?s.raw:String(s);return t.length<o.length?t:s},At}var xt,Vr;function fi(){if(Vr)return xt;Vr=1;const i=J(),u=$e(),{ANY:a}=u,s=Be(),l=Q(),E=(o,e,r={})=>{if(o===e)return!0;o=new i(o,r),e=new i(e,r);let c=!1;e:for(const n of o.set){for(const d of e.set){const m=h(n,d,r);if(c=c||m!==null,m)continue e}if(c)return!1}return!0},v=[new u(">=0.0.0-0")],p=[new u(">=0.0.0")],h=(o,e,r)=>{if(o===e)return!0;if(o.length===1&&o[0].semver===a){if(e.length===1&&e[0].semver===a)return!0;r.includePrerelease?o=v:o=p}if(e.length===1&&e[0].semver===a){if(r.includePrerelease)return!0;e=p}const c=new Set;let n,d;for(const S of o)S.operator===">"||S.operator===">="?n=f(n,S,r):S.operator==="<"||S.operator==="<="?d=t(d,S,r):c.add(S.semver);if(c.size>1)return null;let m;if(n&&d){if(m=l(n.semver,d.semver,r),m>0)return null;if(m===0&&(n.operator!==">="||d.operator!=="<="))return null}for(const S of c){if(n&&!s(S,String(n),r)||d&&!s(S,String(d),r))return null;for(const U of e)if(!s(S,String(U),r))return!1;return!0}let g,I,b,_,y=d&&!r.includePrerelease&&d.semver.prerelease.length?d.semver:!1,R=n&&!r.includePrerelease&&n.semver.prerelease.length?n.semver:!1;y&&y.prerelease.length===1&&d.operator==="<"&&y.prerelease[0]===0&&(y=!1);for(const S of e){if(_=_||S.operator===">"||S.operator===">=",b=b||S.operator==="<"||S.operator==="<=",n){if(R&&S.semver.prerelease&&S.semver.prerelease.length&&S.semver.major===R.major&&S.semver.minor===R.minor&&S.semver.patch===R.patch&&(R=!1),S.operator===">"||S.operator===">="){if(g=f(n,S,r),g===S&&g!==n)return!1}else if(n.operator===">="&&!s(n.semver,String(S),r))return!1}if(d){if(y&&S.semver.prerelease&&S.semver.prerelease.length&&S.semver.major===y.major&&S.semver.minor===y.minor&&S.semver.patch===y.patch&&(y=!1),S.operator==="<"||S.operator==="<="){if(I=t(d,S,r),I===S&&I!==d)return!1}else if(d.operator==="<="&&!s(d.semver,String(S),r))return!1}if(!S.operator&&(d||n)&&m!==0)return!1}return!(n&&b&&!d&&m!==0||d&&_&&!n&&m!==0||R||y)},f=(o,e,r)=>{if(!o)return e;const c=l(o.semver,e.semver,r);return c>0?o:c<0||e.operator===">"&&o.operator===">="?e:o},t=(o,e,r)=>{if(!o)return e;const c=l(o.semver,e.semver,r);return c<0?o:c>0||e.operator==="<"&&o.operator==="<="?e:o};return xt=E,xt}var Ct,Hr;function di(){if(Hr)return Ct;Hr=1;const i=_e(),u=Ce(),a=H(),s=En(),l=le(),E=Gn(),v=kn(),p=Vn(),h=Hn(),f=Xn(),t=Wn(),o=zn(),e=Kn(),r=Q(),c=Yn(),n=Zn(),d=Gt(),m=Qn(),g=Jn(),I=Ue(),b=kt(),_=mn(),y=gn(),R=Vt(),S=Ht(),U=_n(),P=ei(),G=$e(),x=J(),$=Be(),T=ri(),w=ni(),N=ii(),L=si(),O=oi(),D=Xt(),A=ai(),q=ci(),C=ui(),j=li(),M=fi();return Ct={parse:l,valid:E,clean:v,inc:p,diff:h,major:f,minor:t,patch:o,prerelease:e,compare:r,rcompare:c,compareLoose:n,compareBuild:d,sort:m,rsort:g,gt:I,lt:b,eq:_,neq:y,gte:R,lte:S,cmp:U,coerce:P,Comparator:G,Range:x,satisfies:$,toComparators:T,maxSatisfying:w,minSatisfying:N,minVersion:L,validRange:O,outside:D,gtr:A,ltr:q,intersects:C,simplifyRange:j,subset:M,SemVer:a,re:i.re,src:i.src,tokens:i.t,SEMVER_SPEC_VERSION:u.SEMVER_SPEC_VERSION,RELEASE_TYPES:u.RELEASE_TYPES,compareIdentifiers:s.compareIdentifiers,rcompareIdentifiers:s.rcompareIdentifiers},Ct}var hi=di();const Xr=xe(hi);var k;(function(i){i.blue="blue",i.nanoS="nanoS",i.nanoSP="nanoSP",i.nanoX="nanoX",i.stax="stax",i.europa="europa"})(k||(k={}));const $t={[k.blue]:{id:k.blue,productName:"LedgerÂ Blue",productIdMM:0,legacyUsbProductId:0,usbOnly:!0,memorySize:480*1024,masks:[822083584,822149120],getBlockSize:i=>4*1024},[k.nanoS]:{id:k.nanoS,productName:"LedgerÂ NanoÂ S",productIdMM:16,legacyUsbProductId:1,usbOnly:!0,memorySize:320*1024,masks:[823132160],getBlockSize:i=>Xr.lt(Xr.coerce(i)??"","2.0.0")?4*1024:2*1024},[k.nanoX]:{id:k.nanoX,productName:"LedgerÂ NanoÂ X",productIdMM:64,legacyUsbProductId:4,usbOnly:!1,memorySize:2*1024*1024,masks:[855638016],getBlockSize:i=>4*1024,bluetoothSpec:[{serviceUuid:"13d63400-2c97-0004-0000-4c6564676572",notifyUuid:"13d63400-2c97-0004-0001-4c6564676572",writeUuid:"13d63400-2c97-0004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-0004-0003-4c6564676572"}]},[k.nanoSP]:{id:k.nanoSP,productName:"Ledger Nano S Plus",productIdMM:80,legacyUsbProductId:5,usbOnly:!0,memorySize:1533*1024,masks:[856686592],getBlockSize:i=>32},[k.stax]:{id:k.stax,productName:"LedgerÂ Stax",productIdMM:96,legacyUsbProductId:6,usbOnly:!1,memorySize:1533*1024,masks:[857735168],getBlockSize:i=>32,bluetoothSpec:[{serviceUuid:"13d63400-2c97-6004-0000-4c6564676572",notifyUuid:"13d63400-2c97-6004-0001-4c6564676572",writeUuid:"13d63400-2c97-6004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-6004-0003-4c6564676572"}]},[k.europa]:{id:k.europa,productName:"LedgerÂ Flex",productIdMM:112,legacyUsbProductId:7,usbOnly:!1,memorySize:1533*1024,masks:[858783744],getBlockSize:i=>32,bluetoothSpec:[{serviceUuid:"13d63400-2c97-3004-0000-4c6564676572",notifyUuid:"13d63400-2c97-3004-0001-4c6564676572",writeUuid:"13d63400-2c97-3004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-3004-0003-4c6564676572"}]}},pi={Blue:k.blue,"Nano S":k.nanoS,"Nano S Plus":k.nanoSP,"Nano X":k.nanoX,Stax:k.stax,Europa:k.europa},Bt=Object.values($t),vi=11415,Ne=i=>{const u=Bt.find(l=>l.legacyUsbProductId===i);if(u)return u;const a=i>>8;return Bt.find(l=>l.productIdMM===a)},Ei=i=>Bt.find(a=>a.id===pi[i]),mi=[],Wr={};for(const i in $t){const u=$t[i],{bluetoothSpec:a}=u;if(a)for(let s=0;s<a.length;s++){const l=a[s];mi.push(l.serviceUuid),Wr[l.serviceUuid]=Wr[l.serviceUuid.replace(/-/g,"")]={deviceModel:u,...l}}}const zr=5;function gi(i){const u=Buffer.alloc(2);return u.writeUInt16BE(i,0),u}const _i={data:Buffer.alloc(0),dataLength:0,sequence:0},yi=(i,u)=>({makeBlocks(a){let s=Buffer.concat([gi(a.length),a]);const l=u-5,E=Math.ceil(s.length/l);s=Buffer.concat([s,Buffer.alloc(E*l-s.length+1).fill(0)]);const v=[];for(let p=0;p<E;p++){const h=Buffer.alloc(5);h.writeUInt16BE(i,0),h.writeUInt8(zr,2),h.writeUInt16BE(p,3);const f=s.slice(p*l,(p+1)*l);v.push(Buffer.concat([h,f]))}return v},reduceResponse(a,s){let{data:l,dataLength:E,sequence:v}=a||_i;if(s.readUInt16BE(0)!==i)throw new te("Invalid channel","InvalidChannel");if(s.readUInt8(2)!==zr)throw new te("Invalid tag","InvalidTag");if(s.readUInt16BE(3)!==v)throw new te("Invalid sequence","InvalidSequence");a||(E=s.readUInt16BE(5)),v++;const p=s.slice(a?5:7);return l=Buffer.concat([l,p]),l.length>E&&(l=l.slice(0,E)),{data:l,dataLength:E,sequence:v}},getReducedResult(a){if(a&&a.dataLength===a.data.length)return a.data}}),bi=i=>["win32","darwin"].includes(process.platform)?i.usagePage===65440:i.interface===0;function ne(){return ae.devices(vi,0).filter(bi)}const oe=class oe extends se{constructor(a,{context:s,logType:l}={}){super({context:s,logType:l});B(this,"device");B(this,"deviceModel");B(this,"channel",Math.floor(Math.random()*65535));B(this,"packetSize",64);B(this,"disconnected",!1);B(this,"setDisconnected",()=>{this.tracer.trace("Setting to disconnected",{alreadyDisconnected:this.disconnected}),this.disconnected||(this.emit("disconnect"),this.disconnected=!0)});B(this,"writeHID",a=>{const s=[0];for(let l=0;l<a.length;l++)s.push(a[l]);try{return this.device.write(s),Promise.resolve()}catch(l){this.tracer.trace(`Received an error during HID write: ${l}`,{error:l});let E=l;return l instanceof Error&&(E=new Re(l.message)),E instanceof Re&&(this.tracer.trace("Disconnected during HID write"),this.setDisconnected()),Promise.reject(E)}});B(this,"readHID",()=>new Promise((a,s)=>this.device.read((l,E)=>{if(!E)return s(new $n);if(l){this.tracer.trace(`Received an error during HID read: ${l}`,{e:l});const v=l&&l.message?new Re(l.message):l;v instanceof Re&&(this.tracer.trace("Disconnected during HID read"),this.setDisconnected()),s(v)}else{const v=Buffer.from(E);a(v)}})));this.updateTraceContext({hidChannel:this.channel}),this.device=a;const E=a.getDeviceInfo();this.tracer.trace(`Connected to HID device ${!!E}`,{info:E}),this.deviceModel=E&&E.product?Ei(E.product):null}static open(a){return Promise.resolve().then(()=>{if(a)return new oe(new ae.HID(a));const s=ne()[0];if(!s)throw new te("NoDevice","NoDevice");return new oe(new ae.HID(s.path))})}async exchange(a){const s=this.tracer.withUpdatedContext({function:"exchange"});return s.trace("Exchanging APDU ..."),await this.exchangeAtomicImpl(async()=>{const{channel:E,packetSize:v}=this;s.withType("apdu").trace(`=> ${a.toString("hex")}`,{channel:E,packetSize:v});const p=yi(E,v),h=p.makeBlocks(a);for(let o=0;o<h.length;o++)await this.writeHID(h[o]);let f,t;for(;!(f=p.getReducedResult(t));){const o=await this.readHID();t=p.reduceResponse(t,o)}return s.withType("apdu").trace(`<= ${f.toString("hex")}`,{channel:E,packetSize:v}),f})}setScrambleKey(){}async close(){await this.exchangeBusyPromise,this.device.close()}};B(oe,"isSupported",()=>Promise.resolve(typeof ae.HID=="function")),B(oe,"list",()=>Promise.resolve(ne().map(a=>a.path))),B(oe,"listen",a=>(ne().forEach(s=>{const l=Ne(s.productId);a.next({type:"add",descriptor:s.path,deviceModel:l,device:s})}),a.complete(),{unsubscribe:()=>{}}));let me=oe;var X={},V={},de={},Oe={exports:{}},Le={exports:{}},Pt,Kr;function Ii(){if(Kr)return Pt;Kr=1;var i={},u=Z,a=Z,s=Z,l=typeof __webpack_require__=="function"?__non_webpack_require__:qt,E=process.config&&process.config.variables||{},v=!!i.PREBUILDS_ONLY,p=process.versions.modules,h=P()?"electron":U()?"node-webkit":"node",f=i.npm_config_arch||s.arch(),t=i.npm_config_platform||s.platform(),o=i.LIBC||(G(t)?"musl":"glibc"),e=i.ARM_VERSION||(f==="arm64"?"8":E.arm_version)||"",r=(process.versions.uv||"").split(".")[0];Pt=c;function c(x){return l(c.resolve(x))}c.resolve=c.path=function(x){x=a.resolve(x||".");try{var $=l(a.join(x,"package.json")).name.toUpperCase().replace(/-/g,"_");i[$+"_PREBUILD"]&&(x=i[$+"_PREBUILD"])}catch{}if(!v){var T=d(a.join(x,"build/Release"),m);if(T)return T;var w=d(a.join(x,"build/Debug"),m);if(w)return w}var N=D(x);if(N)return N;var L=D(a.dirname(process.execPath));if(L)return L;var O=["platform="+t,"arch="+f,"runtime="+h,"abi="+p,"uv="+r,e?"armv="+e:"","libc="+o,"node="+process.versions.node,process.versions.electron?"electron="+process.versions.electron:"",typeof __webpack_require__=="function"?"webpack=true":""].filter(Boolean).join(" ");throw new Error("No native build was found for "+O+`
    loaded from: `+x+`
`);function D(A){var q=n(a.join(A,"prebuilds")).map(g),C=q.filter(I(t,f)).sort(b)[0];if(C){var j=a.join(A,"prebuilds",C.name),M=n(j).map(_),F=M.filter(y(h,p)),W=F.sort(S(h))[0];if(W)return a.join(j,W.file)}}};function n(x){try{return u.readdirSync(x)}catch{return[]}}function d(x,$){var T=n(x).filter($);return T[0]&&a.join(x,T[0])}function m(x){return/\.node$/.test(x)}function g(x){var $=x.split("-");if($.length===2){var T=$[0],w=$[1].split("+");if(T&&w.length&&w.every(Boolean))return{name:x,platform:T,architectures:w}}}function I(x,$){return function(T){return T==null||T.platform!==x?!1:T.architectures.includes($)}}function b(x,$){return x.architectures.length-$.architectures.length}function _(x){var $=x.split("."),T=$.pop(),w={file:x,specificity:0};if(T==="node"){for(var N=0;N<$.length;N++){var L=$[N];if(L==="node"||L==="electron"||L==="node-webkit")w.runtime=L;else if(L==="napi")w.napi=!0;else if(L.slice(0,3)==="abi")w.abi=L.slice(3);else if(L.slice(0,2)==="uv")w.uv=L.slice(2);else if(L.slice(0,4)==="armv")w.armv=L.slice(4);else if(L==="glibc"||L==="musl")w.libc=L;else continue;w.specificity++}return w}}function y(x,$){return function(T){return!(T==null||T.runtime&&T.runtime!==x&&!R(T)||T.abi&&T.abi!==$&&!T.napi||T.uv&&T.uv!==r||T.armv&&T.armv!==e||T.libc&&T.libc!==o)}}function R(x){return x.runtime==="node"&&x.napi}function S(x){return function($,T){return $.runtime!==T.runtime?$.runtime===x?-1:1:$.abi!==T.abi?$.abi?-1:1:$.specificity!==T.specificity?$.specificity>T.specificity?-1:1:0}}function U(){return!!(process.versions&&process.versions.nw)}function P(){return process.versions&&process.versions.electron||i.ELECTRON_RUN_AS_NODE?!0:typeof window<"u"&&window.process&&window.process.type==="renderer"}function G(x){return x==="linux"&&u.existsSync("/etc/alpine-release")}return c.parseTags=_,c.matchTags=y,c.compareTags=S,c.parseTuple=g,c.matchTuple=I,c.compareTuples=b,Pt}var Yr;function wi(){if(Yr)return Le.exports;Yr=1;const i=typeof __webpack_require__=="function"?__non_webpack_require__:qt;return typeof i.addon=="function"?Le.exports=i.addon.bind(i):Le.exports=Ii(),Le.exports}var Si=Oe.exports,Zr;function qe(){if(Zr)return Oe.exports;Zr=1,Object.defineProperty(Si,"__esModule",{value:!0});var i=Z,u=wi()(i.join(__dirname,"..",".."));return Oe.exports=u,Oe.exports}var he={},K={},Qr;function yn(){if(Qr)return K;Qr=1;var i=K&&K.__extends||function(){var p=function(h,f){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])},p(h,f)};return function(h,f){if(typeof f!="function"&&f!==null)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");p(h,f);function t(){this.constructor=h}h.prototype=f===null?Object.create(f):(t.prototype=f.prototype,new t)}}();Object.defineProperty(K,"__esModule",{value:!0}),K.OutEndpoint=K.InEndpoint=K.Endpoint=void 0;var u=ge(),a=qe(),s=function(p){return p&&p instanceof Uint8Array},l=function(p){i(h,p);function h(f,t){var o=p.call(this)||this;return o.device=f,o.timeout=0,o.descriptor=t,o.address=t.bEndpointAddress,o.transferType=t.bmAttributes&3,o}return h.prototype.clearHalt=function(f){return this.device.__clearHalt(this.address,f)},h.prototype.makeTransfer=function(f,t){return new a.Transfer(this.device,this.address,this.transferType,f,t)},h}(u.EventEmitter);K.Endpoint=l;var E=function(p){i(h,p);function h(f,t){var o=p.call(this,f,t)||this;return o.direction="in",o.pollTransfers=[],o.pollTransferSize=0,o.pollPending=0,o.pollActive=!1,o}return h.prototype.transfer=function(f,t){var o=this,e=Buffer.alloc(f),r=function(c,n,d){t.call(o,c,e.slice(0,d))};try{this.makeTransfer(this.timeout,r).submit(e)}catch(c){process.nextTick(function(){return t.call(o,c)})}return this},h.prototype.startPoll=function(f,t,o){var e=this,r=function(n,d,m,g){n?n.errno!=a.LIBUSB_TRANSFER_CANCELLED&&(e.emit("error",n),e.pollActive&&e.stopPoll()):e.emit("data",m.slice(0,g)),e.pollActive?c(d):(e.pollPending--,e.pollPending===0&&(e.pollTransfers=[],e.pollActive=!1,e.emit("end")))},c=function(n){try{n.submit(Buffer.alloc(e.pollTransferSize),function(d,m,g){r(d,n,m,g)})}catch(d){e.emit("error",d),e.stopPoll()}};return this.pollTransfers=this.startPollTransfers(f,t,function(n,d,m){r(n,this,d,m)}),this.pollTransfers.forEach(c),this.pollPending=this.pollTransfers.length,this.pollTransfers},h.prototype.startPollTransfers=function(f,t,o){if(f===void 0&&(f=3),t===void 0&&(t=this.descriptor.wMaxPacketSize),this.pollActive)throw new Error("Polling already active");this.pollTransferSize=t,this.pollActive=!0,this.pollPending=0;for(var e=[],r=0;r<f;r++){var c=this.makeTransfer(0,o);e[r]=c}return e},h.prototype.stopPoll=function(f){if(!this.pollActive)throw new Error("Polling is not active.");for(var t=0;t<this.pollTransfers.length;t++)try{this.pollTransfers[t].cancel()}catch(o){this.emit("error",o)}this.pollActive=!1,f&&this.once("end",f)},h}(l);K.InEndpoint=E;var v=function(p){i(h,p);function h(){var f=p!==null&&p.apply(this,arguments)||this;return f.direction="out",f}return h.prototype.transfer=function(f,t){var o=this;f?s(f)||(f=Buffer.from(f)):f=Buffer.alloc(0);var e=function(r,c,n){t&&t.call(o,r,n||0)};try{this.makeTransfer(this.timeout,e).submit(f)}catch(r){process.nextTick(function(){return e(r)})}return this},h.prototype.transferWithZLP=function(f,t){f.length%this.descriptor.wMaxPacketSize===0?(this.transfer(f),this.transfer(Buffer.alloc(0),t)):this.transfer(f,t)},h}(l);return K.OutEndpoint=v,K}var Jr;function bn(){if(Jr)return he;Jr=1,Object.defineProperty(he,"__esModule",{value:!0}),he.Interface=void 0;var i=qe(),u=yn(),a=function(){function s(l,E){this.device=l,this.id=E,this.altSetting=0,this.refresh()}return s.prototype.refresh=function(){if(this.device.configDescriptor){this.descriptor=this.device.configDescriptor.interfaces[this.id][this.altSetting],this.interfaceNumber=this.descriptor.bInterfaceNumber,this.endpoints=[];for(var l=this.descriptor.endpoints.length,E=0;E<l;E++){var v=this.descriptor.endpoints[E],p=v.bEndpointAddress&i.LIBUSB_ENDPOINT_IN?u.InEndpoint:u.OutEndpoint;this.endpoints[E]=new p(this.device,v)}}},s.prototype.claim=function(){this.device.__claimInterface(this.id)},s.prototype.release=function(l,E){var v=this,p=!1;typeof l=="boolean"?p=l:E=l;var h=function(){v.device.__releaseInterface(v.id,function(t){t||(v.altSetting=0,v.refresh()),E&&E.call(v,t)})};if(!p||this.endpoints.length===0)h();else{var f=this.endpoints.length;this.endpoints.forEach(function(t){t.direction==="in"&&t.pollActive?(t.once("end",function(){--f===0&&h()}),t.stopPoll()):--f===0&&h()})}},s.prototype.isKernelDriverActive=function(){return this.device.__isKernelDriverActive(this.id)},s.prototype.detachKernelDriver=function(){return this.device.__detachKernelDriver(this.id)},s.prototype.attachKernelDriver=function(){return this.device.__attachKernelDriver(this.id)},s.prototype.setAltSetting=function(l,E){var v=this;this.device.__setInterface(this.id,l,function(p){p||(v.altSetting=l,v.refresh()),E&&E.call(v,p)})},s.prototype.endpoint=function(l){return this.endpoints.find(function(E){return E.address===l})},s}();return he.Interface=a,he}var pe={},en;function In(){if(en)return pe;en=1,Object.defineProperty(pe,"__esModule",{value:!0}),pe.Capability=void 0;var i=function(){function u(a,s){if(this.device=a,this.id=s,!a._bosDescriptor)throw new Error("bosDescriptor not found");this.descriptor=a._bosDescriptor.capabilities[this.id],this.type=this.descriptor.bDevCapabilityType,this.data=this.descriptor.dev_capability_data}return u}();return pe.Capability=i,pe}var tn;function Ri(){if(tn)return de;tn=1,Object.defineProperty(de,"__esModule",{value:!0}),de.ExtendedDevice=void 0;var i=qe(),u=bn(),a=In(),s=function(v){return!!v&&v instanceof Uint8Array},l=1e3,E=function(){function v(){this._timeout=l}return Object.defineProperty(v.prototype,"timeout",{get:function(){return this._timeout||l},set:function(p){this._timeout=p},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"configDescriptor",{get:function(){try{return this.__getConfigDescriptor()}catch(p){if(p.errno===i.LIBUSB_ERROR_NOT_FOUND)return;throw p}},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"allConfigDescriptors",{get:function(){try{return this.__getAllConfigDescriptors()}catch(p){if(p.errno===i.LIBUSB_ERROR_NOT_FOUND)return[];throw p}},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"parent",{get:function(){return this.__getParent()},enumerable:!1,configurable:!0}),v.prototype.open=function(p){if(p===void 0&&(p=!0),this.__open(),p!==!1){this.interfaces=[];for(var h=this.configDescriptor?this.configDescriptor.interfaces.length:0,f=0;f<h;f++)this.interfaces[f]=new u.Interface(this,f)}},v.prototype.close=function(){this.__close(),this.interfaces=void 0},v.prototype.setConfiguration=function(p,h){var f=this;this.__setConfiguration(p,function(t){if(!t){f.interfaces=[];for(var o=f.configDescriptor?f.configDescriptor.interfaces.length:0,e=0;e<o;e++)f.interfaces[e]=new u.Interface(f,e)}h&&h.call(f,t)})},v.prototype.controlTransfer=function(p,h,f,t,o,e){var r=this,c=!!(p&i.LIBUSB_ENDPOINT_IN),n=c?o:o.length;if(c){if(!(o>=0))throw new TypeError("Expected size number for IN transfer (based on bmRequestType)")}else if(!s(o))throw new TypeError("Expected buffer for OUT transfer (based on bmRequestType)");var d=Buffer.alloc(n+i.LIBUSB_CONTROL_SETUP_SIZE);d.writeUInt8(p,0),d.writeUInt8(h,1),d.writeUInt16LE(f,2),d.writeUInt16LE(t,4),d.writeUInt16LE(n,6),c||d.set(o,i.LIBUSB_CONTROL_SETUP_SIZE);var m=new i.Transfer(this,0,i.LIBUSB_TRANSFER_TYPE_CONTROL,this.timeout,function(g,I,b){e&&(c?e.call(r,g,I.slice(i.LIBUSB_CONTROL_SETUP_SIZE,i.LIBUSB_CONTROL_SETUP_SIZE+b)):e.call(r,g,b))});try{m.submit(d)}catch(g){e&&process.nextTick(function(){return e.call(r,g,void 0)})}return this},v.prototype.interface=function(p){if(!this.interfaces)throw new Error("Device must be open before searching for interfaces");p=p||0;for(var h=0;h<this.interfaces.length;h++)if(this.interfaces[h].interfaceNumber===p)return this.interfaces[h];throw new Error("Interface not found for address: "+p)},v.prototype.getStringDescriptor=function(p,h){if(p===0){h();return}var f=1033,t=255;this.controlTransfer(i.LIBUSB_ENDPOINT_IN,i.LIBUSB_REQUEST_GET_DESCRIPTOR,i.LIBUSB_DT_STRING<<8|p,f,t,function(o,e){if(o)return h(o);h(void 0,s(e)?e.toString("utf16le",2):void 0)})},v.prototype.getBosDescriptor=function(p){var h=this;if(this._bosDescriptor)return p(void 0,this._bosDescriptor);if(this.deviceDescriptor.bcdUSB<513)return p(void 0,void 0);this.controlTransfer(i.LIBUSB_ENDPOINT_IN,i.LIBUSB_REQUEST_GET_DESCRIPTOR,i.LIBUSB_DT_BOS<<8,0,i.LIBUSB_DT_BOS_SIZE,function(f,t){if(f)return f.errno===i.LIBUSB_TRANSFER_STALL?p(void 0,void 0):p(f,void 0);if(!s(t))return p(void 0,void 0);var o=t.readUInt16LE(2);h.controlTransfer(i.LIBUSB_ENDPOINT_IN,i.LIBUSB_REQUEST_GET_DESCRIPTOR,i.LIBUSB_DT_BOS<<8,0,o,function(e,r){if(e)return e.errno===i.LIBUSB_TRANSFER_STALL?p(void 0,void 0):p(e,void 0);if(!s(r))return p(void 0,void 0);for(var c={bLength:r.readUInt8(0),bDescriptorType:r.readUInt8(1),wTotalLength:r.readUInt16LE(2),bNumDeviceCaps:r.readUInt8(4),capabilities:[]},n=i.LIBUSB_DT_BOS_SIZE;n<c.wTotalLength;){var d={bLength:r.readUInt8(n+0),bDescriptorType:r.readUInt8(n+1),bDevCapabilityType:r.readUInt8(n+2),dev_capability_data:r.slice(n+3,n+r.readUInt8(n+0))};c.capabilities.push(d),n+=d.bLength}h._bosDescriptor=c,p(void 0,h._bosDescriptor)})})},v.prototype.getCapabilities=function(p){var h=this,f=[];this.getBosDescriptor(function(t,o){if(t)return p(t,void 0);for(var e=o?o.capabilities.length:0,r=0;r<e;r++)f.push(new a.Capability(h,r));p(void 0,f)})},v}();return de.ExtendedDevice=E,de}var ve,rn;function Ae(){if(rn)return ve;rn=1;var i=ve&&ve.__values||function(e){var r=typeof Symbol=="function"&&Symbol.iterator,c=r&&e[r],n=0;if(c)return c.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")},u=ge(),a=Ri(),s=qe();s.INIT_ERROR&&console.warn("Failed to initialize libusb."),Object.setPrototypeOf(s,u.EventEmitter.prototype),Object.defineProperty(s,"pollHotplug",{value:!1,writable:!0}),Object.defineProperty(s,"pollHotplugDelay",{value:500,writable:!0}),Object.getOwnPropertyNames(a.ExtendedDevice.prototype).forEach(function(e){Object.defineProperty(s.Device.prototype,e,Object.getOwnPropertyDescriptor(a.ExtendedDevice.prototype,e)||Object.create(null))});var l=new Set,E=function(){var e,r,c,n,d=new Set(s.getDeviceList());try{for(var m=i(d),g=m.next();!g.done;g=m.next()){var I=g.value;l.has(I)||s.emit("attach",I)}}catch(y){e={error:y}}finally{try{g&&!g.done&&(r=m.return)&&r.call(m)}finally{if(e)throw e.error}}try{for(var b=i(l),_=b.next();!_.done;_=b.next()){var I=_.value;d.has(I)||s.emit("detach",I)}}catch(y){c={error:y}}finally{try{_&&!_.done&&(n=b.return)&&n.call(b)}finally{if(c)throw c.error}}l=d},v=!1,p=function(e){if(e===void 0&&(e=!1),e)v=!0;else if(v)E();else return;setTimeout(function(){return p()},s.pollHotplugDelay)},h=function(){return setTimeout(function(){return E()},s.pollHotplugDelay)},f=0,t=function(){f=s.pollHotplug?0:s._supportedHotplugEvents(),f!==1&&(l=new Set(s.getDeviceList())),f?(s._enableHotplugEvents(),f===2&&(s.on("attachIds",h),s.on("detachIds",h))):p(!0)},o=function(){f?(s._disableHotplugEvents(),f===2&&(s.off("attachIds",h),s.off("detachIds",h))):v=!1};return s.on("newListener",function(e){if(!(e!=="attach"&&e!=="detach")){var r=s.listenerCount("attach")+s.listenerCount("detach");r===0&&t()}}),s.on("removeListener",function(e){if(!(e!=="attach"&&e!=="detach")){var r=s.listenerCount("attach")+s.listenerCount("detach");r===0&&o()}}),ve=s,ve}var Y={},nn;function wn(){if(nn)return Y;nn=1;var i=Y&&Y.__awaiter||function(t,o,e,r){function c(n){return n instanceof e?n:new e(function(d){d(n)})}return new(e||(e=Promise))(function(n,d){function m(b){try{I(r.next(b))}catch(_){d(_)}}function g(b){try{I(r.throw(b))}catch(_){d(_)}}function I(b){b.done?n(b.value):c(b.value).then(m,g)}I((r=r.apply(t,o||[])).next())})},u=Y&&Y.__generator||function(t,o){var e={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},r,c,n,d;return d={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function m(I){return function(b){return g([I,b])}}function g(I){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,c&&(n=I[0]&2?c.return:I[0]?c.throw||((n=c.return)&&n.call(c),0):c.next)&&!(n=n.call(c,I[1])).done)return n;switch(c=0,n&&(I=[I[0]&2,n.value]),I[0]){case 0:case 1:n=I;break;case 4:return e.label++,{value:I[1],done:!1};case 5:e.label++,c=I[1],I=[0];continue;case 7:I=e.ops.pop(),e.trys.pop();continue;default:if(n=e.trys,!(n=n.length>0&&n[n.length-1])&&(I[0]===6||I[0]===2)){e=0;continue}if(I[0]===3&&(!n||I[1]>n[0]&&I[1]<n[3])){e.label=I[1];break}if(I[0]===6&&e.label<n[1]){e.label=n[1],n=I;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(I);break}n[2]&&e.ops.pop(),e.trys.pop();continue}I=o.call(t,e)}catch(b){I=[6,b],c=0}finally{r=n=0}if(I[0]&5)throw I[1];return{value:I[0]?I[1]:void 0,done:!0}}},a=Y&&Y.__values||function(t){var o=typeof Symbol=="function"&&Symbol.iterator,e=o&&t[o],r=0;if(e)return e.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Y,"__esModule",{value:!0}),Y.WebUSBDevice=void 0;var s=Ae(),l=Z,E=3,v=127,p=1,h=0,f=function(){function t(o){this.device=o,this.configurations=[];var e=this.decodeVersion(o.deviceDescriptor.bcdUSB);this.usbVersionMajor=e.major,this.usbVersionMinor=e.minor,this.usbVersionSubminor=e.sub,this.deviceClass=o.deviceDescriptor.bDeviceClass,this.deviceSubclass=o.deviceDescriptor.bDeviceSubClass,this.deviceProtocol=o.deviceDescriptor.bDeviceProtocol,this.vendorId=o.deviceDescriptor.idVendor,this.productId=o.deviceDescriptor.idProduct;var r=this.decodeVersion(o.deviceDescriptor.bcdDevice);this.deviceVersionMajor=r.major,this.deviceVersionMinor=r.minor,this.deviceVersionSubminor=r.sub}return t.createInstance=function(o){return i(this,void 0,void 0,function(){var e;return u(this,function(r){switch(r.label){case 0:return e=new t(o),[4,e.initialize()];case 1:return r.sent(),[2,e]}})})},Object.defineProperty(t.prototype,"configuration",{get:function(){if(this.device.configDescriptor){var o=this.device.configDescriptor.bConfigurationValue;return this.configurations.find(function(e){return e.configurationValue===o})}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"opened",{get:function(){return!!this.device.interfaces},enumerable:!1,configurable:!0}),t.prototype.open=function(){return i(this,void 0,void 0,function(){return u(this,function(o){try{if(this.opened)return[2];this.device.open()}catch(e){throw new Error("open error: "+e)}return[2]})})},t.prototype.close=function(){return i(this,void 0,void 0,function(){var o,e,r,c,n,d,m;return u(this,function(g){switch(g.label){case 0:if(g.trys.push([0,12,,13]),!this.opened)return[2];g.label=1;case 1:if(g.trys.push([1,10,,11]),!this.configuration)return[3,9];g.label=2;case 2:g.trys.push([2,7,8,9]),o=a(this.configuration.interfaces),e=o.next(),g.label=3;case 3:return e.done?[3,6]:(r=e.value,[4,this._releaseInterface(r.interfaceNumber)]);case 4:g.sent(),this.configuration.interfaces[this.configuration.interfaces.indexOf(r)]={interfaceNumber:r.interfaceNumber,alternate:r.alternate,alternates:r.alternates,claimed:!1},g.label=5;case 5:return e=o.next(),[3,3];case 6:return[3,9];case 7:return c=g.sent(),d={error:c},[3,9];case 8:try{e&&!e.done&&(m=o.return)&&m.call(o)}finally{if(d)throw d.error}return[7];case 9:return[3,11];case 10:return g.sent(),[3,11];case 11:return this.device.close(),[3,13];case 12:throw n=g.sent(),new Error("close error: "+n);case 13:return[2]}})})},t.prototype.selectConfiguration=function(o){return i(this,void 0,void 0,function(){var e,r,c;return u(this,function(n){switch(n.label){case 0:if(!this.opened||!this.device.configDescriptor)throw new Error("selectConfiguration error: invalid state");if(this.device.configDescriptor.bConfigurationValue===o)return[2];if(e=this.configurations.find(function(d){return d.configurationValue===o}),!e)throw new Error("selectConfiguration error: configuration not found");n.label=1;case 1:return n.trys.push([1,3,,4]),r=l.promisify(this.device.setConfiguration).bind(this.device),[4,r(o)];case 2:return n.sent(),[3,4];case 3:throw c=n.sent(),new Error("selectConfiguration error: "+c);case 4:return[2]}})})},t.prototype.claimInterface=function(o){return i(this,void 0,void 0,function(){var e;return u(this,function(r){if(!this.opened)throw new Error("claimInterface error: invalid state");if(!this.configuration)throw new Error("claimInterface error: interface not found");if(e=this.configuration.interfaces.find(function(c){return c.interfaceNumber===o}),!e)throw new Error("claimInterface error: interface not found");if(e.claimed)return[2];try{this.device.interface(o).claim(),this.configuration.interfaces[this.configuration.interfaces.indexOf(e)]={interfaceNumber:o,alternate:e.alternate,alternates:e.alternates,claimed:!0}}catch(c){throw new Error("claimInterface error: "+c)}return[2]})})},t.prototype.releaseInterface=function(o){return i(this,void 0,void 0,function(){var e;return u(this,function(r){switch(r.label){case 0:return[4,this._releaseInterface(o)];case 1:return r.sent(),this.configuration&&(e=this.configuration.interfaces.find(function(c){return c.interfaceNumber===o}),e&&(this.configuration.interfaces[this.configuration.interfaces.indexOf(e)]={interfaceNumber:o,alternate:e.alternate,alternates:e.alternates,claimed:!1})),[2]}})})},t.prototype.selectAlternateInterface=function(o,e){return i(this,void 0,void 0,function(){var r,c,n,d;return u(this,function(m){switch(m.label){case 0:if(!this.opened)throw new Error("selectAlternateInterface error: invalid state");if(!this.configuration)throw new Error("selectAlternateInterface error: interface not found");if(r=this.configuration.interfaces.find(function(g){return g.interfaceNumber===o}),!r)throw new Error("selectAlternateInterface error: interface not found");if(!r.claimed)throw new Error("selectAlternateInterface error: invalid state");m.label=1;case 1:return m.trys.push([1,3,,4]),c=this.device.interface(o),n=l.promisify(c.setAltSetting).bind(c),[4,n(e)];case 2:return m.sent(),[3,4];case 3:throw d=m.sent(),new Error("selectAlternateInterface error: "+d);case 4:return[2]}})})},t.prototype.controlTransferIn=function(o,e){return i(this,void 0,void 0,function(){var r,c,n,d;return u(this,function(m){switch(m.label){case 0:return m.trys.push([0,2,,3]),r=this.controlTransferParamsToType(o,s.LIBUSB_ENDPOINT_IN),c=l.promisify(this.device.controlTransfer).bind(this.device),[4,c(r,o.request,o.value,o.index,e)];case 1:return n=m.sent(),[2,{data:n?new DataView(new Uint8Array(n).buffer):void 0,status:"ok"}];case 2:if(d=m.sent(),d.errno===s.LIBUSB_TRANSFER_STALL)return[2,{status:"stall"}];if(d.errno===s.LIBUSB_TRANSFER_OVERFLOW)return[2,{status:"babble"}];throw new Error("controlTransferIn error: "+d);case 3:return[2]}})})},t.prototype.controlTransferOut=function(o,e){return i(this,void 0,void 0,function(){var r,c,n,d,m;return u(this,function(g){switch(g.label){case 0:return g.trys.push([0,2,,3]),r=this.controlTransferParamsToType(o,s.LIBUSB_ENDPOINT_OUT),c=l.promisify(this.device.controlTransfer).bind(this.device),n=e?Buffer.from(e):Buffer.alloc(0),[4,c(r,o.request,o.value,o.index,n)];case 1:return d=g.sent(),[2,{bytesWritten:d,status:"ok"}];case 2:if(m=g.sent(),m.errno===s.LIBUSB_TRANSFER_STALL)return[2,{bytesWritten:0,status:"stall"}];throw new Error("controlTransferOut error: "+m);case 3:return[2]}})})},t.prototype.clearHalt=function(o,e){return i(this,void 0,void 0,function(){var r,c,n;return u(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),r=e|(o==="in"?s.LIBUSB_ENDPOINT_IN:s.LIBUSB_ENDPOINT_OUT),c=l.promisify(this.device.controlTransfer).bind(this.device),[4,c(s.LIBUSB_RECIPIENT_ENDPOINT,p,h,r,0)];case 1:return d.sent(),[3,3];case 2:throw n=d.sent(),new Error("clearHalt error: "+n);case 3:return[2]}})})},t.prototype.transferIn=function(o,e){return i(this,void 0,void 0,function(){var r,c,n,d;return u(this,function(m){switch(m.label){case 0:return m.trys.push([0,2,,3]),r=this.getEndpoint(o|s.LIBUSB_ENDPOINT_IN),c=l.promisify(r.transfer).bind(r),[4,c(e)];case 1:return n=m.sent(),[2,{data:n?new DataView(new Uint8Array(n).buffer):void 0,status:"ok"}];case 2:if(d=m.sent(),d.errno===s.LIBUSB_TRANSFER_STALL)return[2,{status:"stall"}];if(d.errno===s.LIBUSB_TRANSFER_OVERFLOW)return[2,{status:"babble"}];throw new Error("transferIn error: "+d);case 3:return[2]}})})},t.prototype.transferOut=function(o,e){return i(this,void 0,void 0,function(){var r,c,n,d,m;return u(this,function(g){switch(g.label){case 0:return g.trys.push([0,2,,3]),r=this.getEndpoint(o|s.LIBUSB_ENDPOINT_OUT),c=l.promisify(r.transfer).bind(r),n=Buffer.from(e),[4,c(n)];case 1:return d=g.sent(),[2,{bytesWritten:d,status:"ok"}];case 2:if(m=g.sent(),m.errno===s.LIBUSB_TRANSFER_STALL)return[2,{bytesWritten:0,status:"stall"}];throw new Error("transferOut error: "+m);case 3:return[2]}})})},t.prototype.reset=function(){return i(this,void 0,void 0,function(){var o,e;return u(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),o=l.promisify(this.device.reset).bind(this.device),[4,o()];case 1:return r.sent(),[3,3];case 2:throw e=r.sent(),new Error("reset error: "+e);case 3:return[2]}})})},t.prototype.isochronousTransferIn=function(o,e){return i(this,void 0,void 0,function(){return u(this,function(r){throw new Error("isochronousTransferIn error: method not implemented")})})},t.prototype.isochronousTransferOut=function(o,e,r){return i(this,void 0,void 0,function(){return u(this,function(c){throw new Error("isochronousTransferOut error: method not implemented")})})},t.prototype.forget=function(){return i(this,void 0,void 0,function(){return u(this,function(o){throw new Error("forget error: method not implemented")})})},t.prototype.initialize=function(){return i(this,void 0,void 0,function(){var o,e,r,c,n;return u(this,function(d){switch(d.label){case 0:return d.trys.push([0,5,6,7]),this.opened||this.device.open(),o=this,[4,this.getStringDescriptor(this.device.deviceDescriptor.iManufacturer)];case 1:return o.manufacturerName=d.sent(),e=this,[4,this.getStringDescriptor(this.device.deviceDescriptor.iProduct)];case 2:return e.productName=d.sent(),r=this,[4,this.getStringDescriptor(this.device.deviceDescriptor.iSerialNumber)];case 3:return r.serialNumber=d.sent(),c=this,[4,this.getConfigurations()];case 4:return c.configurations=d.sent(),[3,7];case 5:throw n=d.sent(),new Error("initialize error: "+n);case 6:return this.opened&&this.device.close(),[7];case 7:return[2]}})})},t.prototype.decodeVersion=function(o){var e=("0000"+o.toString(16)).slice(-4);return{major:parseInt(e.substr(0,2),void 0),minor:parseInt(e.substr(2,1),void 0),sub:parseInt(e.substr(3,1),void 0)}},t.prototype.getStringDescriptor=function(o){return i(this,void 0,void 0,function(){var e,r;return u(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),e=l.promisify(this.device.getStringDescriptor).bind(this.device),[4,e(o)];case 1:return r=c.sent(),[2,r?r.toString():""];case 2:return c.sent(),[2,""];case 3:return[2]}})})},t.prototype.getConfigurations=function(){return i(this,void 0,void 0,function(){var o,e,r,c,n,d,m,g,I,b,_,y,R,S,U,P,G,x,$,T=this;return u(this,function(w){switch(w.label){case 0:o=[],w.label=1;case 1:w.trys.push([1,14,15,16]),e=a(this.device.allConfigDescriptors),r=e.next(),w.label=2;case 2:if(r.done)return[3,13];c=r.value,n=[],d=function(N){var L,O,D,A,q,C,j,M,F,W,Wt,je,Fe,ye,zt,be,Kt,Ie;return u(this,function(ie){switch(ie.label){case 0:L=[],ie.label=1;case 1:ie.trys.push([1,6,7,8]),O=(ye=void 0,a(N)),D=O.next(),ie.label=2;case 2:if(D.done)return[3,5];A=D.value,q=[];try{for(C=(be=void 0,a(A.endpoints)),j=C.next();!j.done;j=C.next())M=j.value,q.push({endpointNumber:M.bEndpointAddress&v,direction:M.bEndpointAddress&s.LIBUSB_ENDPOINT_IN?"in":"out",type:(M.bmAttributes&E)===s.LIBUSB_TRANSFER_TYPE_BULK?"bulk":(M.bmAttributes&E)===s.LIBUSB_TRANSFER_TYPE_INTERRUPT?"interrupt":"isochronous",packetSize:M.wMaxPacketSize})}catch(Me){be={error:Me}}finally{try{j&&!j.done&&(Kt=C.return)&&Kt.call(C)}finally{if(be)throw be.error}}return W=(F=L).push,Ie={alternateSetting:A.bAlternateSetting,interfaceClass:A.bInterfaceClass,interfaceSubclass:A.bInterfaceSubClass,interfaceProtocol:A.bInterfaceProtocol},[4,m.getStringDescriptor(A.iInterface)];case 3:W.apply(F,[(Ie.interfaceName=ie.sent(),Ie.endpoints=q,Ie)]),ie.label=4;case 4:return D=O.next(),[3,2];case 5:return[3,8];case 6:return Wt=ie.sent(),ye={error:Wt},[3,8];case 7:try{D&&!D.done&&(zt=O.return)&&zt.call(O)}finally{if(ye)throw ye.error}return[7];case 8:return je=N[0].bInterfaceNumber,Fe=L.find(function(Me){return Me.alternateSetting===T.device.interface(je).altSetting}),Fe&&n.push({interfaceNumber:je,alternate:Fe,alternates:L,claimed:!1}),[2]}})},m=this,w.label=3;case 3:w.trys.push([3,8,9,10]),g=(G=void 0,a(c.interfaces)),I=g.next(),w.label=4;case 4:return I.done?[3,7]:(b=I.value,[5,d(b)]);case 5:w.sent(),w.label=6;case 6:return I=g.next(),[3,4];case 7:return[3,10];case 8:return _=w.sent(),G={error:_},[3,10];case 9:try{I&&!I.done&&(x=g.return)&&x.call(g)}finally{if(G)throw G.error}return[7];case 10:return R=(y=o).push,$={configurationValue:c.bConfigurationValue},[4,this.getStringDescriptor(c.iConfiguration)];case 11:R.apply(y,[($.configurationName=w.sent(),$.interfaces=n,$)]),w.label=12;case 12:return r=e.next(),[3,2];case 13:return[3,16];case 14:return S=w.sent(),U={error:S},[3,16];case 15:try{r&&!r.done&&(P=e.return)&&P.call(e)}finally{if(U)throw U.error}return[7];case 16:return[2,o]}})})},t.prototype.getEndpoint=function(o){var e,r;if(this.device.interfaces)try{for(var c=a(this.device.interfaces),n=c.next();!n.done;n=c.next()){var d=n.value,m=d.endpoint(o);if(m)return m}}catch(g){e={error:g}}finally{try{n&&!n.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}},t.prototype.controlTransferParamsToType=function(o,e){var r=o.recipient==="device"?s.LIBUSB_RECIPIENT_DEVICE:o.recipient==="interface"?s.LIBUSB_RECIPIENT_INTERFACE:o.recipient==="endpoint"?s.LIBUSB_RECIPIENT_ENDPOINT:s.LIBUSB_RECIPIENT_OTHER,c=o.requestType==="standard"?s.LIBUSB_REQUEST_TYPE_STANDARD:o.requestType==="class"?s.LIBUSB_REQUEST_TYPE_CLASS:s.LIBUSB_REQUEST_TYPE_VENDOR;return r|c|e},t.prototype._releaseInterface=function(o){return i(this,void 0,void 0,function(){var e,r,c,n;return u(this,function(d){switch(d.label){case 0:if(!this.opened)throw new Error("releaseInterface error: invalid state");if(!this.configuration)throw new Error("releaseInterface error: interface not found");if(e=this.configuration.interfaces.find(function(m){return m.interfaceNumber===o}),!e)throw new Error("releaseInterface error: interface not found");if(!e.claimed)return[2];d.label=1;case 1:return d.trys.push([1,3,,4]),r=this.device.interface(o),c=l.promisify(r.release).bind(r),[4,c()];case 2:return d.sent(),[3,4];case 3:throw n=d.sent(),new Error("releaseInterface error: "+n);case 4:return[2]}})})},t}();return Y.WebUSBDevice=f,Y}var sn;function on(){if(sn)return V;sn=1;var i=V&&V.__extends||function(){var e=function(r,c){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,d){n.__proto__=d}||function(n,d){for(var m in d)Object.prototype.hasOwnProperty.call(d,m)&&(n[m]=d[m])},e(r,c)};return function(r,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");e(r,c);function n(){this.constructor=r}r.prototype=c===null?Object.create(c):(n.prototype=c.prototype,new n)}}(),u=V&&V.__awaiter||function(e,r,c,n){function d(m){return m instanceof c?m:new c(function(g){g(m)})}return new(c||(c=Promise))(function(m,g){function I(y){try{_(n.next(y))}catch(R){g(R)}}function b(y){try{_(n.throw(y))}catch(R){g(R)}}function _(y){y.done?m(y.value):d(y.value).then(I,b)}_((n=n.apply(e,r||[])).next())})},a=V&&V.__generator||function(e,r){var c={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},n,d,m,g;return g={next:I(0),throw:I(1),return:I(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function I(_){return function(y){return b([_,y])}}function b(_){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,d&&(m=_[0]&2?d.return:_[0]?d.throw||((m=d.return)&&m.call(d),0):d.next)&&!(m=m.call(d,_[1])).done)return m;switch(d=0,m&&(_=[_[0]&2,m.value]),_[0]){case 0:case 1:m=_;break;case 4:return c.label++,{value:_[1],done:!1};case 5:c.label++,d=_[1],_=[0];continue;case 7:_=c.ops.pop(),c.trys.pop();continue;default:if(m=c.trys,!(m=m.length>0&&m[m.length-1])&&(_[0]===6||_[0]===2)){c=0;continue}if(_[0]===3&&(!m||_[1]>m[0]&&_[1]<m[3])){c.label=_[1];break}if(_[0]===6&&c.label<m[1]){c.label=m[1],m=_;break}if(m&&c.label<m[2]){c.label=m[2],c.ops.push(_);break}m[2]&&c.ops.pop(),c.trys.pop();continue}_=r.call(e,c)}catch(y){_=[6,y],d=0}finally{n=m=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}},s=V&&V.__values||function(e){var r=typeof Symbol=="function"&&Symbol.iterator,c=r&&e[r],n=0;if(c)return c.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")},l=V&&V.__read||function(e,r){var c=typeof Symbol=="function"&&e[Symbol.iterator];if(!c)return e;var n=c.call(e),d,m=[],g;try{for(;(r===void 0||r-- >0)&&!(d=n.next()).done;)m.push(d.value)}catch(I){g={error:I}}finally{try{d&&!d.done&&(c=n.return)&&c.call(n)}finally{if(g)throw g.error}}return m},E=V&&V.__spreadArray||function(e,r){for(var c=0,n=r.length,d=e.length;c<n;c++,d++)e[d]=r[c];return e};Object.defineProperty(V,"__esModule",{value:!0}),V.WebUSB=V.getWebUsb=void 0;var v=Ae(),p=ge(),h=wn(),f=function(){return navigator&&navigator.usb?navigator.usb:new o};V.getWebUsb=f;var t=function(e){i(r,e);function r(c,n){var d=e.call(this,c)||this;return d.name=n,d}return r}(Error),o=function(){function e(r){var c=this;r===void 0&&(r={}),this.options=r,this.emitter=new p.EventEmitter,this.knownDevices=new Map,this.authorisedDevices=new Set;var n=function(m){return u(c,void 0,void 0,function(){var g,I;return a(this,function(b){switch(b.label){case 0:return[4,this.getWebDevice(m)];case 1:return g=b.sent(),g&&this.isAuthorisedDevice(g)&&(I={type:"connect",device:g},this.emitter.emit("connect",I)),[2]}})})},d=function(m){return u(c,void 0,void 0,function(){var g,I;return a(this,function(b){return this.knownDevices.has(m)&&(g=this.knownDevices.get(m),g&&this.isAuthorisedDevice(g)&&(I={type:"disconnect",device:g},this.emitter.emit("disconnect",I))),[2]})})};this.emitter.on("newListener",function(m){var g=c.emitter.listenerCount(m);g===0&&(m==="connect"?v.addListener("attach",n):m==="disconnect"&&v.addListener("detach",d))}),this.emitter.on("removeListener",function(m){var g=c.emitter.listenerCount(m);g===0&&(m==="connect"?v.removeListener("attach",n):m==="disconnect"&&v.removeListener("detach",d))})}return Object.defineProperty(e.prototype,"onconnect",{set:function(r){this._onconnect&&(this.removeEventListener("connect",this._onconnect),this._onconnect=void 0),r&&(this._onconnect=r,this.addEventListener("connect",this._onconnect))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ondisconnect",{set:function(r){this._ondisconnect&&(this.removeEventListener("disconnect",this._ondisconnect),this._ondisconnect=void 0),r&&(this._ondisconnect=r,this.addEventListener("disconnect",this._ondisconnect))},enumerable:!1,configurable:!0}),e.prototype.addEventListener=function(r,c){this.emitter.addListener(r,c)},e.prototype.removeEventListener=function(r,c){this.emitter.removeListener(r,c)},e.prototype.dispatchEvent=function(r){return!1},e.prototype.requestDevice=function(r){return u(this,void 0,void 0,function(){var c,n,d,m=this;return a(this,function(g){switch(g.label){case 0:if(!r)throw new TypeError("requestDevice error: 1 argument required, but only 0 present");if(r.constructor!=={}.constructor)throw new TypeError("requestDevice error: parameter 1 (options) is not an object");if(!r.filters)throw new TypeError("requestDevice error: required member filters is undefined");if(r.filters.constructor!==[].constructor)throw new TypeError("requestDevice error: the provided value cannot be converted to a sequence");return r.filters.forEach(function(I){if(I.protocolCode&&!I.subclassCode)throw new TypeError("requestDevice error: subclass code is required");if(I.subclassCode&&!I.classCode)throw new TypeError("requestDevice error: class code is required")}),[4,this.loadDevices(r.filters)];case 1:if(c=g.sent(),c=c.filter(function(I){return m.filterDevice(I,r.filters)}),c.length===0)throw new t("Failed to execute 'requestDevice' on 'USB': No device selected.","NotFoundError");g.label=2;case 2:return g.trys.push([2,6,,7]),this.options.devicesFound?[4,this.options.devicesFound(c)]:[3,4];case 3:return d=g.sent(),[3,5];case 4:d=c[0],g.label=5;case 5:if(n=d,!n)throw new t("Failed to execute 'requestDevice' on 'USB': No device selected.","NotFoundError");return this.authorisedDevices.add({vendorId:n.vendorId,productId:n.productId,classCode:n.deviceClass,subclassCode:n.deviceSubclass,protocolCode:n.deviceProtocol,serialNumber:n.serialNumber}),[2,n];case 6:throw g.sent(),new t("Failed to execute 'requestDevice' on 'USB': No device selected.","NotFoundError");case 7:return[2]}})})},e.prototype.getDevices=function(){return u(this,void 0,void 0,function(){var r,c,n=this;return a(this,function(d){switch(d.label){case 0:return r=this.options.allowAllDevices?void 0:this.options.allowedDevices,[4,this.loadDevices(r)];case 1:return c=d.sent(),[2,c.filter(function(m){return n.isAuthorisedDevice(m)})]}})})},e.prototype.loadDevices=function(r){return u(this,void 0,void 0,function(){var c,n,d,m,g,I,b,_,y;return a(this,function(R){switch(R.label){case 0:c=v.getDeviceList(),c=this.quickFilter(c,r),n=new Map,R.label=1;case 1:R.trys.push([1,6,7,8]),d=s(c),m=d.next(),R.label=2;case 2:return m.done?[3,5]:(g=m.value,[4,this.getWebDevice(g)]);case 3:I=R.sent(),I&&n.set(g,I),R.label=4;case 4:return m=d.next(),[3,2];case 5:return[3,8];case 6:return b=R.sent(),_={error:b},[3,8];case 7:try{m&&!m.done&&(y=d.return)&&y.call(d)}finally{if(_)throw _.error}return[7];case 8:return this.knownDevices=n,[2,E([],l(this.knownDevices.values()))]}})})},e.prototype.getWebDevice=function(r){return u(this,void 0,void 0,function(){var c;return a(this,function(n){switch(n.label){case 0:if(this.knownDevices.has(r))return[3,4];this.options.deviceTimeout&&(r.timeout=this.options.deviceTimeout),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,h.WebUSBDevice.createInstance(r)];case 2:return c=n.sent(),this.knownDevices.set(r,c),[3,4];case 3:return n.sent(),[3,4];case 4:return[2,this.knownDevices.get(r)]}})})},e.prototype.quickFilter=function(r,c){return!c||!c.length?r:r.filter(function(n){return c.some(function(d){return!(d.vendorId&&d.vendorId!==n.deviceDescriptor.idVendor||d.productId&&d.productId!==n.deviceDescriptor.idProduct)})})},e.prototype.filterDevice=function(r,c){return!c||!c.length?!0:c.some(function(n){if(n.vendorId&&n.vendorId!==r.vendorId||n.productId&&n.productId!==r.productId)return!1;if(n.classCode){if(!r.configuration)return!1;var d=r.configuration.interfaces.some(function(m){return!(n.classCode&&n.classCode!==m.alternate.interfaceClass||n.subclassCode&&n.subclassCode!==m.alternate.interfaceSubclass||n.protocolCode&&n.protocolCode!==m.alternate.interfaceProtocol)});if(d)return!0}return!(n.classCode&&n.classCode!==r.deviceClass||n.subclassCode&&n.subclassCode!==r.deviceSubclass||n.protocolCode&&n.protocolCode!==r.deviceProtocol||n.serialNumber&&n.serialNumber!==r.serialNumber)})},e.prototype.isAuthorisedDevice=function(r){return this.options.allowAllDevices||this.options.allowedDevices&&this.filterDevice(r,this.options.allowedDevices)?!0:E([],l(this.authorisedDevices.values())).some(function(c){return c.vendorId===r.vendorId&&c.productId===r.productId&&c.classCode===r.deviceClass&&c.subclassCode===r.deviceSubclass&&c.protocolCode===r.deviceProtocol&&c.serialNumber===r.serialNumber})},e}();return V.WebUSB=o,V}var Ut={},an;function Ti(){return an||(an=1,Object.defineProperty(Ut,"__esModule",{value:!0})),Ut}var cn;function Li(){return cn||(cn=1,function(i){var u=X&&X.__createBinding||(Object.create?function(r,c,n,d){d===void 0&&(d=n),Object.defineProperty(r,d,{enumerable:!0,get:function(){return c[n]}})}:function(r,c,n,d){d===void 0&&(d=n),r[d]=c[n]}),a=X&&X.__exportStar||function(r,c){for(var n in r)n!=="default"&&!Object.prototype.hasOwnProperty.call(c,n)&&u(c,r,n)},s=X&&X.__awaiter||function(r,c,n,d){function m(g){return g instanceof n?g:new n(function(I){I(g)})}return new(n||(n=Promise))(function(g,I){function b(R){try{y(d.next(R))}catch(S){I(S)}}function _(R){try{y(d.throw(R))}catch(S){I(S)}}function y(R){R.done?g(R.value):m(R.value).then(b,_)}y((d=d.apply(r,c||[])).next())})},l=X&&X.__generator||function(r,c){var n={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},d,m,g,I;return I={next:b(0),throw:b(1),return:b(2)},typeof Symbol=="function"&&(I[Symbol.iterator]=function(){return this}),I;function b(y){return function(R){return _([y,R])}}function _(y){if(d)throw new TypeError("Generator is already executing.");for(;n;)try{if(d=1,m&&(g=y[0]&2?m.return:y[0]?m.throw||((g=m.return)&&g.call(m),0):m.next)&&!(g=g.call(m,y[1])).done)return g;switch(m=0,g&&(y=[y[0]&2,g.value]),y[0]){case 0:case 1:g=y;break;case 4:return n.label++,{value:y[1],done:!1};case 5:n.label++,m=y[1],y=[0];continue;case 7:y=n.ops.pop(),n.trys.pop();continue;default:if(g=n.trys,!(g=g.length>0&&g[g.length-1])&&(y[0]===6||y[0]===2)){n=0;continue}if(y[0]===3&&(!g||y[1]>g[0]&&y[1]<g[3])){n.label=y[1];break}if(y[0]===6&&n.label<g[1]){n.label=g[1],g=y;break}if(g&&n.label<g[2]){n.label=g[2],n.ops.push(y);break}g[2]&&n.ops.pop(),n.trys.pop();continue}y=c.call(r,n)}catch(R){y=[6,R],m=0}finally{d=g=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},E=X&&X.__values||function(r){var c=typeof Symbol=="function"&&Symbol.iterator,n=c&&r[c],d=0;if(n)return n.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&d>=r.length&&(r=void 0),{value:r&&r[d++],done:!r}}};throw new TypeError(c?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(i,"__esModule",{value:!0}),i.LibUSBException=i.useUsbDkBackend=i.getDeviceList=i.Transfer=i.Device=i.webusb=i.findBySerialNumber=i.findByIds=i.usb=void 0;var v=Z,p=on(),h=Ae();i.usb=h;var f=function(r,c){var n=h.getDeviceList();return n.find(function(d){return d.deviceDescriptor.idVendor===r&&d.deviceDescriptor.idProduct===c})};i.findByIds=f;var t=function(r){return s(void 0,void 0,void 0,function(){var c,n,d,m,g,I,b,_,y,R;return l(this,function(S){switch(S.label){case 0:c=h.getDeviceList(),n=function(U){return!!U.interfaces},S.label=1;case 1:S.trys.push([1,9,10,11]),d=E(c),m=d.next(),S.label=2;case 2:if(m.done)return[3,8];g=m.value,S.label=3;case 3:return S.trys.push([3,5,6,7]),n(g)||g.open(),I=v.promisify(g.getStringDescriptor).bind(g),[4,I(g.deviceDescriptor.iSerialNumber)];case 4:return b=S.sent(),b&&b.toString()===r?[2,g]:[3,7];case 5:return S.sent(),[3,7];case 6:try{n(g)&&g.close()}catch{}return[7];case 7:return m=d.next(),[3,2];case 8:return[3,11];case 9:return _=S.sent(),y={error:_},[3,11];case 10:try{m&&!m.done&&(R=d.return)&&R.call(d)}finally{if(y)throw y.error}return[7];case 11:return[2,void 0]}})})};i.findBySerialNumber=t;var o=new p.WebUSB;i.webusb=o;var e=Ae();Object.defineProperty(i,"Device",{enumerable:!0,get:function(){return e.Device}}),Object.defineProperty(i,"Transfer",{enumerable:!0,get:function(){return e.Transfer}}),Object.defineProperty(i,"getDeviceList",{enumerable:!0,get:function(){return e.getDeviceList}}),Object.defineProperty(i,"useUsbDkBackend",{enumerable:!0,get:function(){return e.useUsbDkBackend}}),Object.defineProperty(i,"LibUSBException",{enumerable:!0,get:function(){return e.LibUSBException}}),a(In(),i),a(Ti(),i),a(yn(),i),a(bn(),i),a(on(),i),a(wn(),i)}(X)),X}var De=Li(),Di=Ln();const Ni=xe(Di),Oi=(i,u)=>{const a=new dn;a.setMaxListeners(0);let s=ne();const l=e=>e.path,E=()=>[...new Set(ne().map(e=>l(e)))],v=e=>s.find(r=>e.includes(l(r)));let p=E();const f=Ni(()=>{if(u())z("hid-listen","Polling skipped, re-debouncing"),f();else{z("hid-listen","Polling for added or removed devices");let e=!1;const r=E(),c=r.filter(d=>!p.includes(d));c.length>0?(z("hid-listen","New device found:",c),s=ne(),a.emit("add",v(c)),e=!0):z("hid-listen","No new device found");const n=p.filter(d=>!r.includes(d));n.length>0?(z("hid-listen","Removed device found:",n),a.emit("remove",v(n)),s=s.filter(d=>!n.includes(l(d))),e=!0):z("hid-listen","No removed device found"),e&&(p=r)}},i),t=e=>{z("hid-listen","Device add detected:",e),f()};De.usb.on("attach",t),z("hid-listen","attach listener added");const o=e=>{z("hid-listen","Device removal detected:",e),f()};return De.usb.on("detach",o),z("hid-listen","detach listener added"),{stop:()=>{z("hid-listen","Stop received, removing listeners and cancelling pending debounced polls"),f.cancel(),De.usb.removeListener("attach",t),De.usb.removeListener("detach",o)},events:a}};let un=500,ln=()=>!1;const ee=class ee extends me{static open(u){return Promise.resolve().then(()=>{if(u)return new ee(new ae.HID(u));const a=ne()[0];if(!a)throw new te("NoDevice","NoDevice");return new ee(new ae.HID(a.path))})}};B(ee,"isSupported",me.isSupported),B(ee,"list",me.list),B(ee,"setListenDevicesDebounce",u=>{un=u}),B(ee,"setListenDevicesPollingSkip",u=>{ln=u}),B(ee,"setListenDevicesDebug",()=>{console.warn("setListenDevicesDebug is deprecated. Use @ledgerhq/logs instead. No logs will get emitted there anymore.")}),B(ee,"listen",u=>{let a=!1;Promise.resolve(ne()).then(h=>{for(const f of h)if(!a){const t=f.path,o=Ne(f.productId);u.next({type:"add",descriptor:t,device:f,deviceModel:o})}});const{events:s,stop:l}=Oi(un,ln),E=h=>{if(a||!h)return;const f=Ne(h.productId);u.next({type:"add",descriptor:h.path,deviceModel:f,device:h})},v=h=>{if(a||!h)return;const f=Ne(h.productId);u.next({type:"remove",descriptor:h.path,deviceModel:f,device:h})};s.on("add",E),s.on("remove",v);function p(){a=!0,s.removeListener("add",E),s.removeListener("remove",v),l()}return{unsubscribe:p}});let fn=ee;export{fn as default};
